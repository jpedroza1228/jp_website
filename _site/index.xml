<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>log([J]onathan [And]rew [P]edroza)</title>
<link>https://log-of-jandp.com/index.html</link>
<atom:link href="https://log-of-jandp.com/index.xml" rel="self" type="application/rss+xml"/>
<description></description>
<image>
<url>https://log-of-jandp.com/avatar.jpg</url>
<title>log([J]onathan [And]rew [P]edroza)</title>
<link>https://log-of-jandp.com/index.html</link>
</image>
<generator>quarto-1.3.340</generator>
<lastBuildDate>Thu, 02 Jun 2022 07:00:00 GMT</lastBuildDate>
<item>
  <title>Prophet Model</title>
  <link>https://log-of-jandp.com/posts/2022-06-02-prophet-model/index.html</link>
  <description><![CDATA[ 




<p>As I start looking for non-academic positions, I wanted to practice forecasting as I didn’t really have much experience with these types of models. <strong>NOTE: This is for practicing forecasting skills and you should not trust this model with your own stocks.</strong> After plenty of reading,</p>
<p><img src="https://log-of-jandp.com/posts/2022-06-02-prophet-model/https:/media.giphy.com/media/ql6hxonaYC6EE/giphy.gif" class="img-fluid" alt="reading book"> I finally have some understanding of how to utilize these models. This post started because even after a BA, 2 masters degrees, and a doctorate, my brother still has no clue what I do. He, along with most of my family think I am a Clinical Psychologist. <img src="https://log-of-jandp.com/posts/2022-06-02-prophet-model/https:/media.giphy.com/media/l4EpgzkiwfFJKADLy/giphy.gif" class="img-fluid" alt="psychologist"></p>
<p>So for me to try and make my brother understand what I do, I thought I would show him with something that he has become interested with recently; stocks. So for this post, I’ll</p>
<ul>
<li><p>load stock data from <a href="https://www.google.com/finance/">Google Finance</a></p></li>
<li><p>visualize some data</p></li>
<li><p>train a prophet model</p></li>
<li><p>test that prophet model</p></li>
<li><p>see how well that model predicts other stock data</p></li>
</ul>
<p>Below are all the sites for the packages I used.</p>
<ul>
<li><p><a href="https://www.tidyverse.org/">tidyverse</a></p></li>
<li><p><a href="https://business-science.github.io/timetk/">timetk</a></p></li>
<li><p><a href="https://business-science.github.io/modeltime/">modeltime</a></p></li>
<li><p><a href="https://www.tidymodels.org/">tidymodels</a></p></li>
<li><p><a href="https://facebook.github.io/prophet/">prophet</a></p></li>
<li><p><a href="https://googlesheets4.tidyverse.org/">googlesheets4</a></p></li>
<li><p><a href="https://lubridate.tidyverse.org/">lubridate</a></p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidymodels)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(prophet)</span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(lubridate)</span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(modeltime)</span>
<span id="cb1-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(timetk)</span></code></pre></div>
</div>
<section id="loading-data" class="level2">
<h2 class="anchored" data-anchor-id="loading-data">Loading Data</h2>
<p>To load the Google Finance data, I decided to pick a stock that my brother had, which in this case was <a href="https://www.google.com/finance/quote/JBLU:NASDAQ">JetBlue</a>. A cool feature about Google Finance and Google Sheets is that you can use the following formula in a Google Sheet on the first cell of the first column <code>=GOOGLEFINANCE("JBLU", "price", DATE(2000,1,1), DATE(2025, 1, 1), "DAILY")</code> and it will give you the date and stock closing values for whatever period you’d like. The example above provides Google financial data for <code>JBLU</code> or the abbreviation for JetBlue stock. It also provides the price of the stock from the first day that there is data on JetBlue stocks, which in this case is April 12th 2002. You can also choose the period of time for the stock prices. I decided to look at daily data.</p>
<p><a href="https://docs.google.com/spreadsheets/d/1wYpTEQqreipZVeZRq0VV9r-o8FPgM8hGoFT_QhGCOVI/edit#gid=0">JetBlue Sheet</a></p>
<p>Here I have a copy of my Google Sheet for JetBlue that I will use to train and test my Prophet model. Instead of having a <code>.csv</code> file on my local machine, I decided to keep this on Google Drive so that it constantly updates with the Google Finance function. This meant that I had to use the <code>googlesheets4</code> package to load the data from a Google Sheet. I also changed the name and class of the date variable to make it a date variable instead of a date and time variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">googlesheets4<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gs4_deauth</span>()</span>
<span id="cb2-2"></span>
<span id="cb2-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_set</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_light</span>())</span>
<span id="cb2-4"></span>
<span id="cb2-5">jet <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> </span>
<span id="cb2-6">  googlesheets4<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_sheet</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'https://docs.google.com/spreadsheets/d/1SpRXsC3kXDaQLUfC6cPIOvsqxDF6updhgHRJeT8PTog/edit#gid=0'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-7">  janitor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_names</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb2-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ds =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_date</span>(date))</span></code></pre></div>
</div>
<section id="cleaning-up-the-data" class="level3">
<h3 class="anchored" data-anchor-id="cleaning-up-the-data">Cleaning Up the Data</h3>
<p>Based on some visualizations below, I also decided to create some additional variables from the date variable. Specifically, I used <code>lubridate's wday()</code> function to create a new variable that gives you the actual day from the corresponding cell’s date. I also used the <code>ts_clean_vec</code> function from <code>time_tk</code> to clean for outliers in the stock price values. There are additional arguments for the function, like applying a Box-Cox transformation but that is for a multiplicative trend, which this model does not appear to fit since the variation in the outcome does not grow exponentially. I’ll also include 2002 as the reference year for the year variable and make sure that my data is arranged by date.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">jetblue <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> jet <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">actual_day =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wday</span>(ds,</span>
<span id="cb3-3">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb3-4">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clean =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ts_clean_vec</span>(close)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">separate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> date,</span>
<span id="cb3-6">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">into =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'year_num'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'month_num'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'day_num'</span>),</span>
<span id="cb3-7">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'-'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">year_num =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(year_num),</span>
<span id="cb3-9">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">year_num =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">relevel</span>(year_num, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ref =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'2002'</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">separate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> day_num,</span>
<span id="cb3-11">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">into =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'day_num'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'drop'</span>),</span>
<span id="cb3-12">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">' '</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">day_num =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(day_num),</span>
<span id="cb3-14">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">month_num =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(month_num)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>drop) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(ds)</span></code></pre></div>
</div>
</section>
</section>
<section id="visualizing-data" class="level2">
<h2 class="anchored" data-anchor-id="visualizing-data">Visualizing Data</h2>
<p>Starting with some quick visualizations, we can see that the only area that there is a difference in the variation of the stock prices is in the beginning of 2020. I wonder what that could have been <img src="https://log-of-jandp.com/posts/2022-06-02-prophet-model/https:/media.giphy.com/media/lOIuDYVIo8C1y5oMQB/giphy.gif" class="img-fluid" alt="friends">.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">jetblue <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb4-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(year_num, month_num) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb4-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarize</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">var_value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(close)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb4-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ungroup</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb4-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(month_num, var_value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb4-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb4-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vars</span>(year_num))</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://log-of-jandp.com/posts/2022-06-02-prophet-model/index_files/figure-html/variation over time-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Next, we can look at the histograms for the outcome of interest. If we look at the histograms, we can see that there are potential outliers in the original stock prices data. We can also see that cleaning the variable removed the potential outliers.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">only_numeric <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> jetblue <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb5-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(close, clean)</span>
<span id="cb5-3"></span>
<span id="cb5-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map2</span>(only_numeric,</span>
<span id="cb5-5">     <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(only_numeric),</span>
<span id="cb5-6">     <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> only_numeric,</span>
<span id="cb5-7">             <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(.x)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-8">       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'white'</span>,</span>
<span id="cb5-9">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'dodgerblue'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-10">       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_vline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xintercept =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(.x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-11">                    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(.x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-12">                    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(.x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-13">                    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(.x),</span>
<span id="cb5-14">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'red'</span>,</span>
<span id="cb5-15">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.25</span>,</span>
<span id="cb5-16">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-17">       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_vline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xintercept =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(.x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span></span>
<span id="cb5-18">                    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(.x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span></span>
<span id="cb5-19">                    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(.x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span></span>
<span id="cb5-20">                    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(.x),</span>
<span id="cb5-21">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'red'</span>,</span>
<span id="cb5-22">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.25</span>,</span>
<span id="cb5-23">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linetype =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-24">       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> .y))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$close</code></pre>
</div>
<div class="cell-output-display">
<p><img src="https://log-of-jandp.com/posts/2022-06-02-prophet-model/index_files/figure-html/histograms-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
$clean</code></pre>
</div>
<div class="cell-output-display">
<p><img src="https://log-of-jandp.com/posts/2022-06-02-prophet-model/index_files/figure-html/histograms-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>There will also be a lot of use of the <code>purrr</code> package and the <code>map</code> functions, which are part of the tidyverse. We can also see that in the plot series visualization using <code>modeltime's plot_time_series</code> function, that the cleaned stock prices remove the outliers. So from here on out, I’ll be using the cleaned stock prices.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map2</span>(only_numeric,</span>
<span id="cb8-2">     <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(only_numeric),</span>
<span id="cb8-3">     <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>only_numeric <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb8-4">       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_time_series</span>(jetblue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>ds,</span>
<span id="cb8-5">                        .x,</span>
<span id="cb8-6">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.interactive =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb8-7">       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> .y))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$close</code></pre>
</div>
<div class="cell-output-display">
<p><img src="https://log-of-jandp.com/posts/2022-06-02-prophet-model/index_files/figure-html/plot time series-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
$clean</code></pre>
</div>
<div class="cell-output-display">
<p><img src="https://log-of-jandp.com/posts/2022-06-02-prophet-model/index_files/figure-html/plot time series-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can also look for anomalies, or points that deviate from the trend. Using the <code>plot_anomaly_diagnostics</code> function from the <code>modeltime</code> package, I can see all the anomalies in the data. I also used ggplot to create my own visualization using the same data. Lastly, we’ll deal with those anomalies by removing them from the dataset. This is not too much of a problem because the Prophet model should be able to handle this fairly easy.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">jetblue <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb11-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_anomaly_diagnostics</span>(ds,</span>
<span id="cb11-3">                           clean,</span>
<span id="cb11-4">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.facet_ncol =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb11-5">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.interactive =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://log-of-jandp.com/posts/2022-06-02-prophet-model/index_files/figure-html/anomaly detection-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1">jetblue <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb12-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tk_anomaly_diagnostics</span>(ds,</span>
<span id="cb12-3">                         clean) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb12-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(ds, observed)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb12-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb12-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> anomaly)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-7">  viridis<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_viridis</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">option =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'D'</span>,</span>
<span id="cb12-8">                               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">discrete =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb12-9">                               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">begin =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb12-10">                               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">end =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://log-of-jandp.com/posts/2022-06-02-prophet-model/index_files/figure-html/anomaly detection-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1">anomaly <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> jetblue <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb13-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tk_anomaly_diagnostics</span>(ds,</span>
<span id="cb13-3">                         clean)</span>
<span id="cb13-4"></span>
<span id="cb13-5">jetblue <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">left_join</span>(jetblue, anomaly) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb13-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(anomaly <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Yes'</span>)</span></code></pre></div>
</div>
<p>We can also look into additional regressors to include in the model by looking into seasonality. We can see some fluctuation in stock prices across the years. We’ll include the year variable as another regressor on the stock prices.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1">jetblue <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb14-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_seasonal_diagnostics</span>(ds,</span>
<span id="cb14-3">                            clean,</span>
<span id="cb14-4">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.interactive =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://log-of-jandp.com/posts/2022-06-02-prophet-model/index_files/figure-html/seasonality-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="training-the-prophet-model" class="level2">
<h2 class="anchored" data-anchor-id="training-the-prophet-model">Training the Prophet Model</h2>
<p>Before we begin, I’m going to designate 10 cores to process any models run.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">05262022</span>)</span>
<span id="cb15-2"></span>
<span id="cb15-3">parallel<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">detectCores</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">parallel_start</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,</span>
<span id="cb17-2">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'parallel'</span>)</span></code></pre></div>
</div>
<p>First, instead of the normal <code>initial_split</code> used for training and testing splits, we’ll use the <code>initial_time_split</code> function from <code>tidymodels</code> to separate the first 80% of the data into training set and the other 20% into the testing set.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">05262022</span>)</span>
<span id="cb18-2">jet_split <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">initial_time_split</span>(jetblue)</span></code></pre></div>
</div>
<section id="prophet-model-function" class="level3">
<h3 class="anchored" data-anchor-id="prophet-model-function">Prophet Model Function</h3>
<p>I decided to create my own Prophet function to be able to use for both training the model and testing it. In this function, I’ve also included parameters that can be changed to see if the model performs better or worse. Lastly, the <code>train = TRUE</code> allows us to practice with the training dataset and then when we’re happy with the model, we can use it to test our model. For our model, we’ll be predicting stock prices with date and comparing each year to the reference year (2002).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1">prophet_mod <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(splits,</span>
<span id="cb19-2">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">changepoints =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">05</span>,</span>
<span id="cb19-3">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">seasonality =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">01</span>,</span>
<span id="cb19-4">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">holiday =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">01</span>,</span>
<span id="cb19-5">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">season_type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'additive'</span>,</span>
<span id="cb19-6">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">day_season =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'auto'</span>,</span>
<span id="cb19-7">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">week_season =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'auto'</span>,</span>
<span id="cb19-8">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">year_season =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'auto'</span>,</span>
<span id="cb19-9">                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">train =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>){</span>
<span id="cb19-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb19-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidymodels)</span>
<span id="cb19-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(modeltime)</span>
<span id="cb19-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(prophet)</span>
<span id="cb19-14">  </span>
<span id="cb19-15">  analy_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">analysis</span>(splits)</span>
<span id="cb19-16">  assess_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">assessment</span>(splits)</span>
<span id="cb19-17">  </span>
<span id="cb19-18">  model <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">prophet_reg</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb19-19">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set_engine</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">engine =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'prophet'</span>,</span>
<span id="cb19-20">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">verbose =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb19-21">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set_args</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prior_scale_changepoints =</span> changepoints,</span>
<span id="cb19-22">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prior_scale_seasonality =</span> seasonality,</span>
<span id="cb19-23">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prior_scale_holidays =</span> holiday,</span>
<span id="cb19-24">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">season =</span> season_type,</span>
<span id="cb19-25">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">seasonality_daily =</span> day_season,</span>
<span id="cb19-26">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">seasonality_weekly =</span> week_season,</span>
<span id="cb19-27">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">seasonality_yearly =</span> year_season) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb19-28">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fit</span>(clean <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> ds <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> year_num, </span>
<span id="cb19-29">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> analy_data)</span>
<span id="cb19-30">  </span>
<span id="cb19-31">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span>(train <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>){</span>
<span id="cb19-32">    train_cali <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> model <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb19-33">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">modeltime_calibrate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">new_data =</span> analy_data)</span>
<span id="cb19-34">    </span>
<span id="cb19-35">    train_acc <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> train_cali <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb19-36">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">modeltime_accuracy</span>()</span>
<span id="cb19-37">    </span>
<span id="cb19-38">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(train_cali, train_acc))</span>
<span id="cb19-39">  }</span>
<span id="cb19-40">  </span>
<span id="cb19-41">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>{</span>
<span id="cb19-42">    test_cali <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> model <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb19-43">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">modeltime_calibrate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">new_data =</span> assess_data)</span>
<span id="cb19-44">    </span>
<span id="cb19-45">    test_acc <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> test_cali <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb19-46">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">modeltime_accuracy</span>()</span>
<span id="cb19-47">    </span>
<span id="cb19-48">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(test_cali, test_acc))</span>
<span id="cb19-49">  }</span>
<span id="cb19-50">}</span></code></pre></div>
</div>
<p>It is worth noting that I’m using the <code>modeltime</code> package to run the prophet model because I believe it is easier to use (especially for later steps) than from Prophet but both can be implemented in this function. Let’s try running this model with the some random parameters I chose from the <a href="https://facebook.github.io/prophet/docs/diagnostics.html#hyperparameter-tuning">Prophet website</a> until realizing that the modeltime parameters are log transformed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">05262022</span>)</span>
<span id="cb20-2">baseline <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">prophet_mod</span>(jet_split,</span>
<span id="cb20-3">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">train =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb20-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pluck</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Disabling daily seasonality. Run prophet with daily.seasonality=TRUE to override this.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Converting to Modeltime Table.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1">baseline</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 x 9
  .model_id .model_desc           .type    mae  mape  mase smape  rmse   rsq
      &lt;int&gt; &lt;chr&gt;                 &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1         1 PROPHET W/ REGRESSORS Fitted 0.958  9.08  4.49  8.89  1.32 0.950</code></pre>
</div>
</div>
<p>So with the model, we can see that the Mean Absolute Scaled Error (MASE) is 4.4874977 and the Root Mean Square Error (RMSE) is 1.317473. Not bad for an initial run. Let’s look at how the model fits the training data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">prophet_mod</span>(jet_split,</span>
<span id="cb25-2">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">train =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span>  </span>
<span id="cb25-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pluck</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb25-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">modeltime_forecast</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">new_data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">training</span>(jet_split),</span>
<span id="cb25-5">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">actual_data =</span> jetblue) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb25-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_modeltime_forecast</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.interactive =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb25-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Prophet Baseline Model'</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://log-of-jandp.com/posts/2022-06-02-prophet-model/index_files/figure-html/baseline visual-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>So the model appears to follow the trend line. We’ll try to tune some of these parameters to see if we can make the model better.</p>
</section>
<section id="tuning-the-model" class="level3">
<h3 class="anchored" data-anchor-id="tuning-the-model">Tuning the Model</h3>
<p>Now, I’ll tune the prior scale values for the model. I’ll use the <code>grid_latin_hypercube</code> from the dials package in <code>tidymodels</code> to choose 5 sets of parameter values to run. I’m also using the <code>rolling_origin</code> from the rsample package in <code>tidymodels</code> because we are working with time series data. This does not create random samples but instead has samples with data points with consecutive values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">05262022</span>)</span>
<span id="cb26-2"></span>
<span id="cb26-3">proph_model <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">prophet_reg</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb26-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set_engine</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">engine =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'prophet'</span>,</span>
<span id="cb26-5">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">verbose =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb26-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set_args</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prior_scale_changepoints =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tune</span>(),</span>
<span id="cb26-7">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prior_scale_seasonality =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tune</span>(),</span>
<span id="cb26-8">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prior_scale_holidays =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tune</span>(),</span>
<span id="cb26-9">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">season =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'additive'</span>,</span>
<span id="cb26-10">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">seasonality_daily =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'auto'</span>,</span>
<span id="cb26-11">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">seasonality_weekly =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'auto'</span>,</span>
<span id="cb26-12">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">seasonality_yearly =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'auto'</span>)</span>
<span id="cb26-13"></span>
<span id="cb26-14">proph_rec <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span></span>
<span id="cb26-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">recipe</span>(clean <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> ds <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> year_num,</span>
<span id="cb26-16">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">training</span>(jet_split))</span>
<span id="cb26-17"></span>
<span id="cb26-18"></span>
<span id="cb26-19"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">05262022</span>)</span>
<span id="cb26-20">train_fold <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span></span>
<span id="cb26-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rolling_origin</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">training</span>(jet_split),</span>
<span id="cb26-22">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">initial =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">270</span>,  </span>
<span id="cb26-23">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">assess =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>, </span>
<span id="cb26-24">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">skip =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>,</span>
<span id="cb26-25">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cumulative =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb26-26"></span>
<span id="cb26-27"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">05262022</span>)</span>
<span id="cb26-28">grid_values <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span></span>
<span id="cb26-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">grid_latin_hypercube</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">prior_scale_changepoints</span>(),</span>
<span id="cb26-30">                       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">prior_scale_seasonality</span>(),</span>
<span id="cb26-31">                       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">prior_scale_holidays</span>(),</span>
<span id="cb26-32">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb26-33"></span>
<span id="cb26-34"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">05262022</span>)</span>
<span id="cb26-35">proph_fit <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tune_grid</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">object =</span> proph_model,</span>
<span id="cb26-36">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">preprocessor =</span> proph_rec,</span>
<span id="cb26-37">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">resamples =</span> train_fold,</span>
<span id="cb26-38">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">grid =</span> grid_values,</span>
<span id="cb26-39">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">control =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">control_grid</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">verbose =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb26-40">                                              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">save_pred =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>,</span>
<span id="cb26-41">                                              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">allow_par =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>))</span>
<span id="cb26-42"></span>
<span id="cb26-43"></span>
<span id="cb26-44">tuned_metrics <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">collect_metrics</span>(proph_fit)</span>
<span id="cb26-45">tuned_metrics <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb26-46">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(.metric <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'rmse'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb26-47">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(mean)</span>
<span id="cb26-48"></span>
<span id="cb26-49"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">saveRDS</span>(tuned_metrics,</span>
<span id="cb26-50">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">file =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'tuned_metrics.rds'</span>)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1">metrics <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span></span>
<span id="cb27-2">  readr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_rds</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C:/Users/cpppe/Desktop/github_projects/JP_posts/posts/2022-06-02-prophet-model/tuned_metrics.rds'</span>)</span>
<span id="cb27-3"></span>
<span id="cb27-4">metrics <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb27-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(.metric <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'rmse'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb27-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(mean)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 x 9
  prior_scale_chan~1 prior~2 prior~3 .metric .esti~4  mean     n std_err .config
               &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;  
1            3.53    1.70e-2 1.12e+0 rmse    standa~  2.43   110   0.193 Prepro~
2            0.884   3.64e+1 1.31e-2 rmse    standa~  2.56   110   0.195 Prepro~
3            0.00139 1.66e-3 1.72e-3 rmse    standa~  2.56   110   0.211 Prepro~
4            0.0549  2.61e-1 2.31e-1 rmse    standa~  2.66   110   0.204 Prepro~
5           43.0     3.80e+0 1.22e+1 rmse    standa~  2.93   110   0.238 Prepro~
# ... with abbreviated variable names 1: prior_scale_changepoints,
#   2: prior_scale_seasonality, 3: prior_scale_holidays, 4: .estimator</code></pre>
</div>
</div>
<p>For the sake of not waiting for this to render, I decided to make a RDS file of the metrics gathered from the tuned Prophet model. We can see that the RMSE value was 2.4252669 and the prior scale changepoint value was 3.5347457, the prior scale seasonality value was 0.0170306, and the prior scale holiday value was 1.1198542.</p>
</section>
<section id="final-training-model" class="level3">
<h3 class="anchored" data-anchor-id="final-training-model">Final Training Model</h3>
<p>I then decided to run the prophet model on the training dataset with the new parameter values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1">final_train <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">prophet_mod</span>(jet_split,</span>
<span id="cb29-2">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">changepoints =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.53</span>,</span>
<span id="cb29-3">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">seasonality =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">017</span>,</span>
<span id="cb29-4">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">holiday =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.12</span>,</span>
<span id="cb29-5">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">train =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span>  </span>
<span id="cb29-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pluck</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb29-7"></span>
<span id="cb29-8">final_train</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 x 9
  .model_id .model_desc           .type    mae  mape  mase smape  rmse   rsq
      &lt;int&gt; &lt;chr&gt;                 &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1         1 PROPHET W/ REGRESSORS Fitted 0.841  7.84  3.94  7.73  1.21 0.957</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">prophet_mod</span>(jet_split,</span>
<span id="cb31-2">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">changepoints =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.53</span>,</span>
<span id="cb31-3">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">seasonality =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">017</span>,</span>
<span id="cb31-4">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">holiday =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.12</span>,</span>
<span id="cb31-5">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">train =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span>  </span>
<span id="cb31-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pluck</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb31-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">modeltime_forecast</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">new_data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">training</span>(jet_split),</span>
<span id="cb31-8">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">actual_data =</span> jetblue) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb31-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_modeltime_forecast</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.interactive =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb31-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'JetBlue Stock Prices - Training Model'</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://log-of-jandp.com/posts/2022-06-02-prophet-model/index_files/figure-html/final train-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can see that when using the whole training set, we have a RMSE of 1.2140588 and a MASE of 3.9392941 so both metrics reduced slightly.</p>
</section>
</section>
<section id="testing-the-model" class="level2">
<h2 class="anchored" data-anchor-id="testing-the-model">Testing the Model</h2>
<p>Finally, let’s test our Prophet model to see how well the model fits.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">prophet_mod</span>(jet_split,</span>
<span id="cb32-2">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">changepoints =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.53</span>,</span>
<span id="cb32-3">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">seasonality =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">017</span>,</span>
<span id="cb32-4">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">holiday =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.12</span>,</span>
<span id="cb32-5">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">train =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb32-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pluck</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb32-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">modeltime_forecast</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">new_data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">testing</span>(jet_split),</span>
<span id="cb32-8">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">actual_data =</span> jetblue) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb32-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_modeltime_forecast</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.interactive =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb32-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'JetBlue Stock Prices - Testing Model'</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://log-of-jandp.com/posts/2022-06-02-prophet-model/index_files/figure-html/testing-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1">test_model <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">prophet_mod</span>(jet_split,</span>
<span id="cb33-2">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">changepoints =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.53</span>,</span>
<span id="cb33-3">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">seasonality =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">017</span>,</span>
<span id="cb33-4">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">holiday =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.12</span>,</span>
<span id="cb33-5">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">train =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb33-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pluck</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb33-7"></span>
<span id="cb33-8">test_model</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 x 9
  .model_id .model_desc           .type   mae  mape  mase smape  rmse   rsq
      &lt;int&gt; &lt;chr&gt;                 &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1         1 PROPHET W/ REGRESSORS Test   18.2  131.  65.0  68.9  20.8 0.481</code></pre>
</div>
</div>
<p>Well, that doesn’t look very good and we can see that with the metrics. The MASE has gotten much worse (65.0040752) and so has the RMSE (20.7536337) <img src="https://log-of-jandp.com/posts/2022-06-02-prophet-model/https:/media.giphy.com/media/32mC2kXYWCsg0/giphy.gif" class="img-fluid" alt="sweating"></p>
</section>
<section id="forecasting-ahead-a-year" class="level2">
<h2 class="anchored" data-anchor-id="forecasting-ahead-a-year">Forecasting Ahead a Year</h2>
<p>Well our model did not fit well to the testing data, but let’s see how it model looks when refit to the full data and forecasted forward a year. So in a year, it seems that JetBlue stock will remain roughly around the same value. It is important to note that the confidence intervals are large and with 95% confidence that values could be between 52.49 and -28.39 (not possible), there is not much confidence that JetBlue stock prices will remain where they are now in a year.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1">future <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> jetblue <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb35-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">future_frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.length_out =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'1 year'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.bind_data =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb35-3"></span>
<span id="cb35-4">future <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span></span>
<span id="cb35-5">  future <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb35-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>year_num, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>month_num, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>day_num) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb35-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">date2 =</span> ds) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb35-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">separate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> date2,</span>
<span id="cb35-9">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">into =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'year_num'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'month_num'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'day_num'</span>),</span>
<span id="cb35-10">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'-'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb35-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">year_num =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(year_num),</span>
<span id="cb35-12">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">year_num =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">relevel</span>(year_num, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ref =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'2002'</span>),</span>
<span id="cb35-13">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">month_num =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(month_num),</span>
<span id="cb35-14">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">day_num =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(day_num)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb35-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(ds)</span>
<span id="cb35-16"></span>
<span id="cb35-17"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glimpse</span>(future)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 5,408
Columns: 17
$ close         &lt;dbl&gt; 13.33, 13.40, 13.57, 13.36, 13.10, 12.93, 12.45, 12.56, ~
$ ds            &lt;date&gt; 2002-04-12, 2002-04-15, 2002-04-16, 2002-04-17, 2002-04~
$ actual_day    &lt;ord&gt; Fri, Mon, Tue, Wed, Thu, Fri, Mon, Tue, Wed, Thu, Fri, M~
$ clean         &lt;dbl&gt; 13.33, 13.40, 13.57, 13.36, 13.10, 12.93, 12.45, 12.56, ~
$ observed      &lt;dbl&gt; 13.33, 13.40, 13.57, 13.36, 13.10, 12.93, 12.45, 12.56, ~
$ season        &lt;dbl&gt; -0.004656862, 0.002322156, -0.005641252, 0.000500758, 0.~
$ trend         &lt;dbl&gt; 13.40744, 13.41698, 13.42651, 13.43605, 13.44559, 13.455~
$ remainder     &lt;dbl&gt; -0.072783284, -0.019298932, 0.149127845, -0.076550796, -~
$ seasadj       &lt;dbl&gt; 13.33466, 13.39768, 13.57564, 13.35950, 13.09252, 12.934~
$ remainder_l1  &lt;dbl&gt; -2.230554, -2.230554, -2.230554, -2.230554, -2.230554, -~
$ remainder_l2  &lt;dbl&gt; 2.251864, 2.251864, 2.251864, 2.251864, 2.251864, 2.2518~
$ anomaly       &lt;chr&gt; "No", "No", "No", "No", "No", "No", "No", "No", "No", "N~
$ recomposed_l1 &lt;dbl&gt; 11.17223, 11.18875, 11.19032, 11.20600, 11.22251, 11.219~
$ recomposed_l2 &lt;dbl&gt; 15.65465, 15.67116, 15.67274, 15.68841, 15.70493, 15.702~
$ year_num      &lt;fct&gt; 2002, 2002, 2002, 2002, 2002, 2002, 2002, 2002, 2002, 20~
$ month_num     &lt;fct&gt; 04, 04, 04, 04, 04, 04, 04, 04, 04, 04, 04, 04, 04, 05, ~
$ day_num       &lt;dbl&gt; 12, 15, 16, 17, 18, 19, 22, 23, 24, 25, 26, 29, 30, 1, 2~</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1">test_model1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">prophet_mod</span>(jet_split,</span>
<span id="cb37-2">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">changepoints =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.53</span>,</span>
<span id="cb37-3">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">seasonality =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">017</span>,</span>
<span id="cb37-4">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">holiday =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.12</span>,</span>
<span id="cb37-5">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">train =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb37-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pluck</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb37-7"></span>
<span id="cb37-8">test_model1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb37-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">modeltime_refit</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> future) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb37-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">modeltime_forecast</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">new_data =</span> future,</span>
<span id="cb37-11">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">actual_data =</span> jetblue) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb37-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_modeltime_forecast</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.interactive =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb37-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Forecasted JetBlue Stock Prices'</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://log-of-jandp.com/posts/2022-06-02-prophet-model/index_files/figure-html/forecasting-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="testing-the-algorithm-on-a-different-airlines-stock-prices" class="level1">
<h1>Testing the Algorithm on a Different Airline’s Stock Prices</h1>
<p>Let’s take this a step further and see how well our algorithm fits on a different airline’s stock price data. We will use the final Prophet model to see if it works well using all of American Airlines data to make predictions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1">link <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'https://docs.google.com/spreadsheets/d/11DWSWLFXT84uGg_mBvVYJevQOsN7ghYovJefH87BJXc/edit#gid=0'</span></span>
<span id="cb38-2"></span>
<span id="cb38-3">amer <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> </span>
<span id="cb38-4">  googlesheets4<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_sheet</span>(link) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb38-5">  janitor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_names</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb38-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ds =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_date</span>(date))</span>
<span id="cb38-7"></span>
<span id="cb38-8">american <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span></span>
<span id="cb38-9">  amer <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb38-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">actual_day =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">wday</span>(ds,</span>
<span id="cb38-11">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>),</span>
<span id="cb38-12">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">clean =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ts_clean_vec</span>(close)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb38-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">separate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> date,</span>
<span id="cb38-14">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">into =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'year_num'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'month_num'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'day_num'</span>),</span>
<span id="cb38-15">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'-'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb38-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">year_num =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(year_num),</span>
<span id="cb38-17">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">year_num =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">relevel</span>(year_num, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ref =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'2013'</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb38-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">separate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> day_num,</span>
<span id="cb38-19">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">into =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'day_num'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'drop'</span>),</span>
<span id="cb38-20">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">' '</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb38-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">day_num =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(day_num),</span>
<span id="cb38-22">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">month_num =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(month_num)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb38-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>drop) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb38-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(ds)</span>
<span id="cb38-25"></span>
<span id="cb38-26"></span>
<span id="cb38-27">model <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">prophet_reg</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb38-28">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set_engine</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">engine =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'prophet'</span>,</span>
<span id="cb38-29">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">verbose =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb38-30">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set_args</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prior_scale_changepoints =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.53</span>,</span>
<span id="cb38-31">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prior_scale_seasonality =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">017</span>,</span>
<span id="cb38-32">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prior_scale_holidays =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.12</span>,</span>
<span id="cb38-33">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">season =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'additive'</span>,</span>
<span id="cb38-34">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">seasonality_daily =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'auto'</span>,</span>
<span id="cb38-35">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">seasonality_weekly =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'auto'</span>,</span>
<span id="cb38-36">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">seasonality_yearly =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'auto'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb38-37">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fit</span>(clean <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> ds <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> year_num, </span>
<span id="cb38-38">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> american)</span>
<span id="cb38-39"></span>
<span id="cb38-40">model_cali <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> model <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb38-41">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">modeltime_calibrate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">new_data =</span> american)</span>
<span id="cb38-42">    </span>
<span id="cb38-43">model_cali <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb38-44">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">modeltime_accuracy</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 x 9
  .model_id .model_desc           .type    mae  mape  mase smape  rmse   rsq
      &lt;int&gt; &lt;chr&gt;                 &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1         1 PROPHET W/ REGRESSORS Fitted  1.66  5.94  2.64  5.87  2.10 0.972</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1">future_amer <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> american <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb40-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">future_frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.length_out =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'1 year'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.bind_data =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb40-3"></span>
<span id="cb40-4">future_amer <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span></span>
<span id="cb40-5">  future_amer <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb40-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>year_num, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>month_num, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>day_num) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb40-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">date2 =</span> ds) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb40-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">separate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> date2,</span>
<span id="cb40-9">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">into =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'year_num'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'month_num'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'day_num'</span>),</span>
<span id="cb40-10">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'-'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb40-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">year_num =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(year_num),</span>
<span id="cb40-12">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">year_num =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">relevel</span>(year_num, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ref =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'2013'</span>),</span>
<span id="cb40-13">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">month_num =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(month_num),</span>
<span id="cb40-14">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">day_num =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(day_num))</span>
<span id="cb40-15"></span>
<span id="cb40-16">model_cali <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb40-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">modeltime_forecast</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">new_data =</span> american,</span>
<span id="cb40-18">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">actual_data =</span> american) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb40-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_modeltime_forecast</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.interactive =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb40-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Predicted American Airlines Stock Prices'</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://log-of-jandp.com/posts/2022-06-02-prophet-model/index_files/figure-html/american airlines-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb41" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1">model_cali <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb41-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">modeltime_refit</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> future_amer) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb41-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">modeltime_forecast</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">new_data =</span> future_amer,</span>
<span id="cb41-4">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">actual_data =</span> american) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb41-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_modeltime_forecast</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.interactive =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb41-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Forecasted American Airlines Stock Prices'</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://log-of-jandp.com/posts/2022-06-02-prophet-model/index_files/figure-html/american airlines-2.png" class="img-fluid" width="672"></p>
</div>
</div>


</section>

 ]]></description>
  <category>Visualizations</category>
  <category>Analysis</category>
  <category>Forecast</category>
  <category>TidyModels</category>
  <category>Modeltime</category>
  <guid>https://log-of-jandp.com/posts/2022-06-02-prophet-model/index.html</guid>
  <pubDate>Thu, 02 Jun 2022 07:00:00 GMT</pubDate>
  <media:content url="https://log-of-jandp.com/posts/2022-06-02-prophet-model/stock_prices.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Graduate Student Satisfaction Exit Surveys</title>
  <link>https://log-of-jandp.com/posts/2021-04-30-grad-student-exit-surveys/index.html</link>
  <description><![CDATA[ 




<p>This post was originally designed because I was interested in working on student experience exit survey data from my department to see if there was a change from 2012 to 2015. These questions are given to every student that graduates from a graduate program at the University of Oregon (UO). This also applies for doctoral students that complete the requirements for a master’s degree on their way to their final PhD program. This data is open to any UO student, staff, or faculty member that has login information for this data.</p>
<p>This data ended up becoming a real time commitment as there was no efficient way to collect data from the pdf files for each College at the UO. An example can be seen <a href="https://github.com/jpedroza1228/exitsurveys/blob/main/pdf_data/exit_surveys/student_experience_survey/2015/2015-AAA-Grad-Experience-Survey-Report.pdf">here</a>. One great resource for collecting data from pdfs was to use the <a href="https://cran.r-project.org/web/packages/pdftools/pdftools.pdf"><em>pdftools</em></a> package, but if you look at the example link provided above the UO Graduate School decided to color code cells in the table, which threw off any function to extract all the values in an efficient manner. Anyway…</p>
<p>The <a href="https://github.com/jpedroza1228/exitsurveys/blob/main/data/student_experience.csv">data</a> and other existing data files can be found <a href="https://github.com/jpedroza1228/exitsurveys/tree/main/pdf_data/exit_surveys">here</a>. When I have some more free time, I may decide to join the other datasets to the student experience data to examine some more interesting questions regarding this data. But for now, lets look at the student experience data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'tidyverse' was built under R version 4.0.5</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>-- Attaching packages --------------------------------------- tidyverse 1.3.1 --</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>v ggplot2 3.3.6     v purrr   0.3.4
v tibble  3.1.8     v dplyr   1.0.9
v tidyr   1.2.0     v stringr 1.4.0
v readr   2.1.2     v forcats 0.5.1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'tidyr' was built under R version 4.0.5</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'readr' was built under R version 4.0.5</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'forcats' was built under R version 4.0.5</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>-- Conflicts ------------------------------------------ tidyverse_conflicts() --
x dplyr::filter() masks stats::filter()
x dplyr::lag()    masks stats::lag()</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_set</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>())</span>
<span id="cb9-2"></span>
<span id="cb9-3">exit <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"https://raw.githubusercontent.com/jpedroza1228/exitsurveys/main/data/student_experience.csv"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb9-4">  janitor<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">clean_names</span>() </span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 103 Columns: 113</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>-- Column specification --------------------------------------------------------
Delimiter: ","
chr   (1): program
dbl (112): year, number_respondents, fac_qual_ex, pro_qual_ex, money_sup_ex,...

i Use `spec()` to retrieve the full column specification for this data.
i Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1">exit<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>program <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_replace_all</span>(exit<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>program,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" "</span>)</span>
<span id="cb12-2">exit<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>program <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">str_to_title</span>(exit<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>program)</span></code></pre></div>
</div>
<p>These exit surveys have several questions that are broken down into percentages about how many of the students agreed or disagreed with the statement. For instance, from the pdf, the first statement is <code>Quality of the faculty</code> in a student’s department. So we can look at that with this first plot. At the same time, we can also look at the difference between the two years of data. In order to look at all the variables at the same time that have the starting string of <code>fac_qual</code>, I’ll use <code>pivot_longer</code> to collect any variable that has that variable string about faculty quality. Since the first and second table on the pdf refer to excellent or good or excellent levels of student satisfaction about faculty quality, I decided to filter out the excellent student satisfaction and move on with only student satisfaction that is either good or excellent.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1">exit <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb13-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> tidyselect<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vars_select</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(exit), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">starts_with</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fac_qual"</span>)),</span>
<span id="cb13-3">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fac_qual"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fac_values"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb13-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(fac_qual <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fac_qual_ex"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb13-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_reorder</span>(program, fac_values), fac_values)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_col</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(year)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dodge2"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Student Experiences by Academic Program"</span>,</span>
<span id="cb13-8">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>,</span>
<span id="cb13-9">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Specific Student Experience"</span>,</span>
<span id="cb13-10">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Ex = Excellent"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_flip</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>fac_qual) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>,</span>
<span id="cb13-14">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>())</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 20 rows containing missing values (geom_col).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="https://log-of-jandp.com/posts/2021-04-30-grad-student-exit-surveys/index_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>So the first shot at making a visual for the two years looks a little cluttered because of using <code>geom_col()</code>. My first decision was to remove the columns and change those to points to make it a little less cluttered and clearer. I already enjoyed the way this looked better. I also decided to clean some things up by changing the names of the variables to better describe what the variables were assessing. I also decided to go back and change the programs to be title case and with spaces rather than underscores.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1">exit <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb15-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> tidyselect<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vars_select</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(exit), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">starts_with</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fac_qual"</span>)),</span>
<span id="cb15-3">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fac_qual"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fac_values"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb15-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(fac_qual <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fac_qual_ex"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb15-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fac_qual =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">recode</span>(fac_qual, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fac_qual_ex_good"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Excellent/Good Faculty Quality"</span>,</span>
<span id="cb15-6">                           <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"fac_qual_fair_poor"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Fair/Poor Faculty Quality"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb15-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_reorder</span>(program, fac_values), fac_values)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(year), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">shape =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(year)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Faculty Quality by Academic Program"</span>,</span>
<span id="cb15-10">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>,</span>
<span id="cb15-11">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Faculty Quality"</span>,</span>
<span id="cb15-12">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Data from University of Oregon's (UO)</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">student satisfaction surveys after graduation"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_flip</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>fac_qual) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#d74122"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#669b3e"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb15-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>,</span>
<span id="cb15-17">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>())</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 20 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="https://log-of-jandp.com/posts/2021-04-30-grad-student-exit-surveys/index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Just in case anyone else is interested in this data, I also created a quick function to see how this visual looked like for other variables in the dataset. For instance, I’ll look at a couple of different variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1">program_experience <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(name){</span>
<span id="cb17-2">  experience <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> {{name}}</span>
<span id="cb17-3">  </span>
<span id="cb17-4">  exit <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb17-5">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> tidyselect<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vars_select</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(exit), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">starts_with</span>(glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"{experience}"</span>))),</span>
<span id="cb17-6">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"exp_names"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"values"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb17-7">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(exp_names <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"{experience}_ex"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span></span>
<span id="cb17-8">             exp_names <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> glue<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">glue</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"{experience}_strong"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb17-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_reorder</span>(program, values), values)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(year), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">shape =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(year)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Student Experiences by Academic Program"</span>,</span>
<span id="cb17-12">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>,</span>
<span id="cb17-13">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_flip</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>exp_names) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#d74122"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#669b3e"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb17-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>,</span>
<span id="cb17-18">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>())</span>
<span id="cb17-19">}</span></code></pre></div>
</div>
<p>Below are all the variables from the dataset.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>  [1] "year"                          "program"                      
  [3] "number_respondents"            "fac_qual_ex"                  
  [5] "pro_qual_ex"                   "money_sup_ex"                 
  [7] "field_dev_pace_ex"             "advising_qual_ex"             
  [9] "smart_community_ex"            "prof_dev_ex"                  
 [11] "equipment_ex"                  "grad_involve_ex"              
 [13] "research_opp_ex"               "grad_fair_assess_ex"          
 [15] "promote_inclu_ex"              "grant_train_ex"               
 [17] "teach_prep_ex"                 "grad_clear_assess_ex"         
 [19] "inter_sup_ex"                  "prof_ethic_train_ex"          
 [21] "fac_qual_ex_good"              "pro_qual_ex_good"             
 [23] "money_sup_ex_good"             "field_dev_pace_ex_good"       
 [25] "advising_qual_ex_good"         "smart_community_ex_good"      
 [27] "prof_dev_ex_good"              "equipment_ex_good"            
 [29] "grad_involve_ex_good"          "research_opp_ex_good"         
 [31] "grad_fair_assess_ex_good"      "promote_inclu_ex_good"        
 [33] "grant_train_ex_good"           "teach_prep_ex_good"           
 [35] "grad_clear_assess_ex_good"     "inter_sup_ex_good"            
 [37] "prof_ethic_train_ex_good"      "fac_qual_fair_poor"           
 [39] "pro_qual_fair_poor"            "money_sup_fair_poor"          
 [41] "field_dev_pace_fair_poor"      "advising_qual_fair_poor"      
 [43] "smart_community_fair_poor"     "prof_dev_fair_poor"           
 [45] "equipment_fair_poor"           "grad_involve_fair_poor"       
 [47] "research_opp_fair_poor"        "grad_fair_assess_fair_poor"   
 [49] "promote_inclu_fair_poor"       "grant_train_fair_poor"        
 [51] "teach_prep_fair_poor"          "grad_clear_assess_fair_poor"  
 [53] "inter_sup_fair_poor"           "prof_ethic_train_fair_poor"   
 [55] "encourage_agree"               "idea_resp_agree"              
 [57] "construct_feed_agree"          "time_feed_agree"              
 [59] "avail_agree"                   "career_sup_agree"             
 [61] "stu_equit_agree"               "ethic_emp_agree"              
 [63] "help_secure_fund_agree"        "help_prof_dev_agree"          
 [65] "publish_help_agree"            "encourage_intel_diff_agree"   
 [67] "comfort_talk_issue_agree"      "encourage_disagree"           
 [69] "idea_resp_disagree"            "construct_feed_disagree"      
 [71] "time_feed_disagree"            "avail_disagree"               
 [73] "career_sup_disagree"           "stu_equit_disagree"           
 [75] "ethic_emp_disagree"            "help_secure_fund_disagree"    
 [77] "help_prof_dev_disagree"        "publish_help_disagree"        
 [79] "encourage_intel_diff_disagree" "comfort_talk_issue_disagree"  
 [81] "collegial_strong"              "encouraging_strong"           
 [83] "supportive_strong"             "intel_open_strong"            
 [85] "inter_open_strong"             "inclu_stu_color_strong"       
 [87] "inclu_gender_strong"           "inclu_intern_stu_strong"      
 [89] "inclu_stu_disab_strong"        "inclu_first_gen_strong"       
 [91] "inclu_stu_sex_orient_strong"   "collegial_agree"              
 [93] "encouraging_agree"             "supportive_agree"             
 [95] "intel_open_agree"              "inter_open_agree"             
 [97] "inclu_stu_color_agree"         "inclu_gender_agree"           
 [99] "inclu_intern_stu_agree"        "inclu_stu_disab_agree"        
[101] "inclu_first_gen_agree"         "inclu_stu_sex_orient_agree"   
[103] "collegial_disagree"            "encouraging_disagree"         
[105] "supportive_disagree"           "intel_open_disagree"          
[107] "inter_open_disagree"           "inclu_stu_color_disagree"     
[109] "inclu_gender_disagree"         "inclu_intern_stu_disagree"    
[111] "inclu_stu_disab_disagree"      "inclu_first_gen_disagree"     
[113] "inclu_stu_sex_orient_disagree"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># student equitable treatment</span></span>
<span id="cb19-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">program_experience</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"stu_equit"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 20 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="https://log-of-jandp.com/posts/2021-04-30-grad-student-exit-surveys/index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># inclusive of students of color</span></span>
<span id="cb21-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">program_experience</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"inclu_stu_color"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 20 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="https://log-of-jandp.com/posts/2021-04-30-grad-student-exit-surveys/index_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># inclusive of gender</span></span>
<span id="cb23-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">program_experience</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"inclu_gender"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 20 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="https://log-of-jandp.com/posts/2021-04-30-grad-student-exit-surveys/index_files/figure-html/unnamed-chunk-5-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># inclusive of international students</span></span>
<span id="cb25-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">program_experience</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"inclu_intern_stu"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 20 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="https://log-of-jandp.com/posts/2021-04-30-grad-student-exit-surveys/index_files/figure-html/unnamed-chunk-5-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># inclusive of students with disabilities</span></span>
<span id="cb27-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">program_experience</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"inclu_stu_disab"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 20 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="https://log-of-jandp.com/posts/2021-04-30-grad-student-exit-surveys/index_files/figure-html/unnamed-chunk-5-5.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># inclusive of first generation students</span></span>
<span id="cb29-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">program_experience</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"inclu_first_gen"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 20 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="https://log-of-jandp.com/posts/2021-04-30-grad-student-exit-surveys/index_files/figure-html/unnamed-chunk-5-6.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># inclusive of students of all sexual orientations</span></span>
<span id="cb31-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">program_experience</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"inclu_stu_sex_orient"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 20 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="https://log-of-jandp.com/posts/2021-04-30-grad-student-exit-surveys/index_files/figure-html/unnamed-chunk-5-7.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Lastly, I decided to look into the difference between the variables I’m most interested in. First, I wanted to look at how graduate students perceive inclusiveness of students of color within their departments. Another variable I was interested in was inclusiveness of first-generation graduate students. Thanks to the <code>plotly</code> package I was able to include some interactive components to the visuals. Specifically zooming in to specific departments give a better idea of the difference between agreeing and disagreeing on these topics. With plotly, you can also click on an option in the legend to only see those values. I also removed the strongly agree option since the agree applied to students that strongly agreed or agreed with the statement.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(plotly)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'plotly' was built under R version 4.0.5</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'plotly'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:ggplot2':

    last_plot</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:stats':

    filter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:graphics':

    layout</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1">stu_color <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> exit <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb39-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> tidyselect<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vars_select</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(exit), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">starts_with</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"inclu_stu_color"</span>)),</span>
<span id="cb39-3">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"stu_color"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"stu_color_values"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb39-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(stu_color <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"inclu_stu_color_strong"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb39-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stu_color =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">recode</span>(stu_color, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"inclu_stu_color_agree"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Agree with Inclusive Environment for Students of Color"</span>,</span>
<span id="cb39-6">                           <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"inclu_stu_color_disagree"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Disagree with Inclusive Environment for Students of Color"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb39-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_reorder</span>(program, stu_color_values), stu_color_values)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb39-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(year), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">shape =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(stu_color)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb39-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Faculty Quality by Academic Program"</span>,</span>
<span id="cb39-10">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>,</span>
<span id="cb39-11">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Faculty Quality"</span>,</span>
<span id="cb39-12">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Data from University of Oregon's (UO)</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">student satisfaction surveys after graduation"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb39-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_flip</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb39-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#d74122"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#669b3e"</span>))</span>
<span id="cb39-15"></span>
<span id="cb39-16">stu_plot <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplotly</span>(stu_color)</span>
<span id="cb39-17">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># layout(legend = list(orientation = "h",</span></span>
<span id="cb39-18">                       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># xanchor = "center",</span></span>
<span id="cb39-19">                       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># x = 0,</span></span>
<span id="cb39-20">                       <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># y = -60)) </span></span>
<span id="cb39-21">stu_plot</span></code></pre></div>
<div class="cell-output-display">
<div id="htmlwidget-8403a2f3b3f771d88872" style="width:100%;height:464px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-8403a2f3b3f771d88872">{"x":{"data":[{"x":[88,55.3,64.7,81.8,74.1,44,63.6,71.4,67.9,57.1,63.2,64,37.5,71,81.8,93.3,57.9,100,88.9,84.6,54.7,66.7,100,84.6,65.2,88.5,42.9,55.3,72.5,75,55.2,62.5,58.6,72.7,71.4,57.1,75,72.7,66.7,50,88.9,38.7,40.7,80.8,90.9,93.3,60,92.3,68.9,76.9,75.6],"y":[21,18,5,2,26,3,49,43,31,22,24,44,16,29,28,32,9,34,30,40,6,14,48,41,12,27,37,23,35,15,8,7,20,17,13,10,45,46,47,50,51,52,53,11,42,39,1,25,19,33,36],"text":["fct_reorder(program, stu_color_values): Music<br />stu_color_values:  88.0<br />as.factor(year): 2012<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Architecture<br />stu_color_values:  55.3<br />as.factor(year): 2012<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Art<br />stu_color_values:  64.7<br />as.factor(year): 2012<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Art History<br />stu_color_values:  81.8<br />as.factor(year): 2012<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Arts Management<br />stu_color_values:  74.1<br />as.factor(year): 2012<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Community Regional Planning<br />stu_color_values:  44.0<br />as.factor(year): 2012<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Historic Preservation<br />stu_color_values:  63.6<br />as.factor(year): 2012<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Interior Architecture<br />stu_color_values:  71.4<br />as.factor(year): 2012<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Landscape Architecture<br />stu_color_values:  67.9<br />as.factor(year): 2012<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Nonprofit Management<br />stu_color_values:  57.1<br />as.factor(year): 2012<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Public Administration<br />stu_color_values:  63.2<br />as.factor(year): 2012<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Communication Society<br />stu_color_values:  64.0<br />as.factor(year): 2012<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Strategic Communication<br />stu_color_values:  37.5<br />as.factor(year): 2012<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Conflict Dispute Resolution<br />stu_color_values:  71.0<br />as.factor(year): 2012<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Accounting<br />stu_color_values:  81.8<br />as.factor(year): 2012<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Lcb Doctoral<br />stu_color_values:  93.3<br />as.factor(year): 2012<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Mba<br />stu_color_values:  57.9<br />as.factor(year): 2012<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Comparative Literature<br />stu_color_values: 100.0<br />as.factor(year): 2012<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Creative Writing<br />stu_color_values:  88.9<br />as.factor(year): 2012<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): East Asian Lang Lit<br />stu_color_values:  84.6<br />as.factor(year): 2012<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): English<br />stu_color_values:  54.7<br />as.factor(year): 2012<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Folklore<br />stu_color_values:  66.7<br />as.factor(year): 2012<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): German<br />stu_color_values: 100.0<br />as.factor(year): 2012<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Linguistics<br />stu_color_values:  84.6<br />as.factor(year): 2012<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Philosophy<br />stu_color_values:  65.2<br />as.factor(year): 2012<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Romance Languages<br />stu_color_values:  88.5<br />as.factor(year): 2012<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Theater Arts<br />stu_color_values:  42.9<br />as.factor(year): 2012<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Biology<br />stu_color_values:  55.3<br />as.factor(year): 2012<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Chemistry<br />stu_color_values:  72.5<br />as.factor(year): 2012<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Computer Information Science<br />stu_color_values:  75.0<br />as.factor(year): 2012<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Geological Sciences<br />stu_color_values:  55.2<br />as.factor(year): 2012<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Human Physiology<br />stu_color_values:  62.5<br />as.factor(year): 2012<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Mathematics<br />stu_color_values:  58.6<br />as.factor(year): 2012<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Physics<br />stu_color_values:  72.7<br />as.factor(year): 2012<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Psychology<br />stu_color_values:  71.4<br />as.factor(year): 2012<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Anthropology<br />stu_color_values:  57.1<br />as.factor(year): 2012<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Economics<br />stu_color_values:  75.0<br />as.factor(year): 2012<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Environmental Studies<br />stu_color_values:  72.7<br />as.factor(year): 2012<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Geography<br />stu_color_values:  66.7<br />as.factor(year): 2012<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): History<br />stu_color_values:  50.0<br />as.factor(year): 2012<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): International Studies<br />stu_color_values:  88.9<br />as.factor(year): 2012<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Political Science<br />stu_color_values:  38.7<br />as.factor(year): 2012<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Sociology<br />stu_color_values:  40.7<br />as.factor(year): 2012<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Communication Disorder Sciences<br />stu_color_values:  80.8<br />as.factor(year): 2012<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Counseling Psychology<br />stu_color_values:  90.9<br />as.factor(year): 2012<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Couples Family Therapy<br />stu_color_values:  93.3<br />as.factor(year): 2012<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Critical Cultural Studies Ed<br />stu_color_values:  60.0<br />as.factor(year): 2012<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Curriculum Teaching<br />stu_color_values:  92.3<br />as.factor(year): 2012<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Educational Meth Policy Lead<br />stu_color_values:  68.9<br />as.factor(year): 2012<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): School Psychology<br />stu_color_values:  76.9<br />as.factor(year): 2012<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Special Education<br />stu_color_values:  75.6<br />as.factor(year): 2012<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(215,65,34,1)","opacity":1,"size":7.55905511811024,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(215,65,34,1)"}},"hoveron":"points","name":"(2012,Agree with Inclusive Environment for Students of Color)","legendgroup":"(2012,Agree with Inclusive Environment for Students of Color)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[2,21.1,0,9.1,7.4,16,9.1,28.6,10.7,0,15.8,16,37.5,9.7,0,0,13.2,0,0,7.7,18.8,11.1,0,7.7,8.7,11.5,42.9,23.4,5.9,0,6.9,4.2,13.8,2.3,10.7,14.3,0,9.1,3.7,31.3,0,41.9,40.7,3.8,4.5,3.3,30,0,6.7,0,12.2],"y":[21,18,5,2,26,3,49,43,31,22,24,44,16,29,28,32,9,34,30,40,6,14,48,41,12,27,37,23,35,15,8,7,20,17,13,10,45,46,47,50,51,52,53,11,42,39,1,25,19,33,36],"text":["fct_reorder(program, stu_color_values): Music<br />stu_color_values:   2.0<br />as.factor(year): 2012<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Architecture<br />stu_color_values:  21.1<br />as.factor(year): 2012<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Art<br />stu_color_values:   0.0<br />as.factor(year): 2012<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Art History<br />stu_color_values:   9.1<br />as.factor(year): 2012<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Arts Management<br />stu_color_values:   7.4<br />as.factor(year): 2012<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Community Regional Planning<br />stu_color_values:  16.0<br />as.factor(year): 2012<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Historic Preservation<br />stu_color_values:   9.1<br />as.factor(year): 2012<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Interior Architecture<br />stu_color_values:  28.6<br />as.factor(year): 2012<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Landscape Architecture<br />stu_color_values:  10.7<br />as.factor(year): 2012<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Nonprofit Management<br />stu_color_values:   0.0<br />as.factor(year): 2012<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Public Administration<br />stu_color_values:  15.8<br />as.factor(year): 2012<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Communication Society<br />stu_color_values:  16.0<br />as.factor(year): 2012<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Strategic Communication<br />stu_color_values:  37.5<br />as.factor(year): 2012<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Conflict Dispute Resolution<br />stu_color_values:   9.7<br />as.factor(year): 2012<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Accounting<br />stu_color_values:   0.0<br />as.factor(year): 2012<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Lcb Doctoral<br />stu_color_values:   0.0<br />as.factor(year): 2012<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Mba<br />stu_color_values:  13.2<br />as.factor(year): 2012<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Comparative Literature<br />stu_color_values:   0.0<br />as.factor(year): 2012<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Creative Writing<br />stu_color_values:   0.0<br />as.factor(year): 2012<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): East Asian Lang Lit<br />stu_color_values:   7.7<br />as.factor(year): 2012<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): English<br />stu_color_values:  18.8<br />as.factor(year): 2012<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Folklore<br />stu_color_values:  11.1<br />as.factor(year): 2012<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): German<br />stu_color_values:   0.0<br />as.factor(year): 2012<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Linguistics<br />stu_color_values:   7.7<br />as.factor(year): 2012<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Philosophy<br />stu_color_values:   8.7<br />as.factor(year): 2012<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Romance Languages<br />stu_color_values:  11.5<br />as.factor(year): 2012<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Theater Arts<br />stu_color_values:  42.9<br />as.factor(year): 2012<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Biology<br />stu_color_values:  23.4<br />as.factor(year): 2012<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Chemistry<br />stu_color_values:   5.9<br />as.factor(year): 2012<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Computer Information Science<br />stu_color_values:   0.0<br />as.factor(year): 2012<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Geological Sciences<br />stu_color_values:   6.9<br />as.factor(year): 2012<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Human Physiology<br />stu_color_values:   4.2<br />as.factor(year): 2012<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Mathematics<br />stu_color_values:  13.8<br />as.factor(year): 2012<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Physics<br />stu_color_values:   2.3<br />as.factor(year): 2012<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Psychology<br />stu_color_values:  10.7<br />as.factor(year): 2012<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Anthropology<br />stu_color_values:  14.3<br />as.factor(year): 2012<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Economics<br />stu_color_values:   0.0<br />as.factor(year): 2012<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Environmental Studies<br />stu_color_values:   9.1<br />as.factor(year): 2012<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Geography<br />stu_color_values:   3.7<br />as.factor(year): 2012<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): History<br />stu_color_values:  31.3<br />as.factor(year): 2012<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): International Studies<br />stu_color_values:   0.0<br />as.factor(year): 2012<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Political Science<br />stu_color_values:  41.9<br />as.factor(year): 2012<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Sociology<br />stu_color_values:  40.7<br />as.factor(year): 2012<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Communication Disorder Sciences<br />stu_color_values:   3.8<br />as.factor(year): 2012<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Counseling Psychology<br />stu_color_values:   4.5<br />as.factor(year): 2012<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Couples Family Therapy<br />stu_color_values:   3.3<br />as.factor(year): 2012<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Critical Cultural Studies Ed<br />stu_color_values:  30.0<br />as.factor(year): 2012<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Curriculum Teaching<br />stu_color_values:   0.0<br />as.factor(year): 2012<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Educational Meth Policy Lead<br />stu_color_values:   6.7<br />as.factor(year): 2012<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): School Psychology<br />stu_color_values:   0.0<br />as.factor(year): 2012<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Special Education<br />stu_color_values:  12.2<br />as.factor(year): 2012<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(215,65,34,1)","opacity":1,"size":7.55905511811024,"symbol":"triangle-up","line":{"width":1.88976377952756,"color":"rgba(215,65,34,1)"}},"hoveron":"points","name":"(2012,Disagree with Inclusive Environment for Students of Color)","legendgroup":"(2012,Disagree with Inclusive Environment for Students of Color)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[71.4,69.6,87.5,33.3,75,46.7,null,71.4,71.4,50,64.3,null,69.6,88.9,63.6,92.9,71.4,87.5,66.7,72.7,88.9,44.4,63.6,86.7,85,70,57.1,null,73.2,72.1,88.5,76.2,85.7,53.8,58.7,61.8,null,null,null,null,null,null,null,60.9,88.6,60,81.3,25,75,64.7,87.5,67.6],"y":[21,18,5,2,26,3,49,43,31,22,24,44,38,16,29,28,32,9,34,30,40,6,14,41,12,27,37,48,23,35,15,8,7,20,17,13,45,46,47,50,51,52,53,11,42,4,39,1,25,19,33,36],"text":["fct_reorder(program, stu_color_values): Music<br />stu_color_values:  71.4<br />as.factor(year): 2015<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Architecture<br />stu_color_values:  69.6<br />as.factor(year): 2015<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Art<br />stu_color_values:  87.5<br />as.factor(year): 2015<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Art History<br />stu_color_values:  33.3<br />as.factor(year): 2015<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Arts Management<br />stu_color_values:  75.0<br />as.factor(year): 2015<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Community Regional Planning<br />stu_color_values:  46.7<br />as.factor(year): 2015<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Historic Preservation<br />stu_color_values:    NA<br />as.factor(year): 2015<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Interior Architecture<br />stu_color_values:  71.4<br />as.factor(year): 2015<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Landscape Architecture<br />stu_color_values:  71.4<br />as.factor(year): 2015<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Nonprofit Management<br />stu_color_values:  50.0<br />as.factor(year): 2015<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Public Administration<br />stu_color_values:  64.3<br />as.factor(year): 2015<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Communication Society<br />stu_color_values:    NA<br />as.factor(year): 2015<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Media Studies<br />stu_color_values:  69.6<br />as.factor(year): 2015<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Strategic Communication<br />stu_color_values:  88.9<br />as.factor(year): 2015<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Conflict Dispute Resolution<br />stu_color_values:  63.6<br />as.factor(year): 2015<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Accounting<br />stu_color_values:  92.9<br />as.factor(year): 2015<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Lcb Doctoral<br />stu_color_values:  71.4<br />as.factor(year): 2015<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Mba<br />stu_color_values:  87.5<br />as.factor(year): 2015<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Comparative Literature<br />stu_color_values:  66.7<br />as.factor(year): 2015<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Creative Writing<br />stu_color_values:  72.7<br />as.factor(year): 2015<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): East Asian Lang Lit<br />stu_color_values:  88.9<br />as.factor(year): 2015<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): English<br />stu_color_values:  44.4<br />as.factor(year): 2015<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Folklore<br />stu_color_values:  63.6<br />as.factor(year): 2015<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Linguistics<br />stu_color_values:  86.7<br />as.factor(year): 2015<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Philosophy<br />stu_color_values:  85.0<br />as.factor(year): 2015<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Romance Languages<br />stu_color_values:  70.0<br />as.factor(year): 2015<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Theater Arts<br />stu_color_values:  57.1<br />as.factor(year): 2015<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): German<br />stu_color_values:    NA<br />as.factor(year): 2015<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Biology<br />stu_color_values:  73.2<br />as.factor(year): 2015<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Chemistry<br />stu_color_values:  72.1<br />as.factor(year): 2015<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Computer Information Science<br />stu_color_values:  88.5<br />as.factor(year): 2015<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Geological Sciences<br />stu_color_values:  76.2<br />as.factor(year): 2015<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Human Physiology<br />stu_color_values:  85.7<br />as.factor(year): 2015<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Mathematics<br />stu_color_values:  53.8<br />as.factor(year): 2015<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Physics<br />stu_color_values:  58.7<br />as.factor(year): 2015<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Psychology<br />stu_color_values:  61.8<br />as.factor(year): 2015<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Economics<br />stu_color_values:    NA<br />as.factor(year): 2015<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Environmental Studies<br />stu_color_values:    NA<br />as.factor(year): 2015<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Geography<br />stu_color_values:    NA<br />as.factor(year): 2015<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): History<br />stu_color_values:    NA<br />as.factor(year): 2015<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): International Studies<br />stu_color_values:    NA<br />as.factor(year): 2015<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Political Science<br />stu_color_values:    NA<br />as.factor(year): 2015<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Sociology<br />stu_color_values:    NA<br />as.factor(year): 2015<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Communication Disorder Sciences<br />stu_color_values:  60.9<br />as.factor(year): 2015<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Counseling Psychology<br />stu_color_values:  88.6<br />as.factor(year): 2015<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Counseling Family Human Services<br />stu_color_values:  60.0<br />as.factor(year): 2015<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Couples Family Therapy<br />stu_color_values:  81.3<br />as.factor(year): 2015<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Critical Cultural Studies Ed<br />stu_color_values:  25.0<br />as.factor(year): 2015<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Curriculum Teaching<br />stu_color_values:  75.0<br />as.factor(year): 2015<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Educational Meth Policy Lead<br />stu_color_values:  64.7<br />as.factor(year): 2015<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): School Psychology<br />stu_color_values:  87.5<br />as.factor(year): 2015<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Special Education<br />stu_color_values:  67.6<br />as.factor(year): 2015<br />as.factor(stu_color): Agree with Inclusive Environment for Students of Color"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(102,155,62,1)","opacity":1,"size":7.55905511811024,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(102,155,62,1)"}},"hoveron":"points","name":"(2015,Agree with Inclusive Environment for Students of Color)","legendgroup":"(2015,Agree with Inclusive Environment for Students of Color)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[5.6,5.4,0,25,6.3,13.3,null,0,14.3,28.6,14.3,null,17.4,0,18.2,0,11.4,4.2,16.7,9.1,0,22.2,9.1,6.7,5,10,28.6,null,7.3,11.8,0,14.3,3.6,23.1,17.4,12.7,null,null,null,null,null,null,null,13,5.7,0,6.3,25,6.3,11.8,6.3,17.6],"y":[21,18,5,2,26,3,49,43,31,22,24,44,38,16,29,28,32,9,34,30,40,6,14,41,12,27,37,48,23,35,15,8,7,20,17,13,45,46,47,50,51,52,53,11,42,4,39,1,25,19,33,36],"text":["fct_reorder(program, stu_color_values): Music<br />stu_color_values:   5.6<br />as.factor(year): 2015<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Architecture<br />stu_color_values:   5.4<br />as.factor(year): 2015<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Art<br />stu_color_values:   0.0<br />as.factor(year): 2015<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Art History<br />stu_color_values:  25.0<br />as.factor(year): 2015<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Arts Management<br />stu_color_values:   6.3<br />as.factor(year): 2015<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Community Regional Planning<br />stu_color_values:  13.3<br />as.factor(year): 2015<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Historic Preservation<br />stu_color_values:    NA<br />as.factor(year): 2015<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Interior Architecture<br />stu_color_values:   0.0<br />as.factor(year): 2015<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Landscape Architecture<br />stu_color_values:  14.3<br />as.factor(year): 2015<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Nonprofit Management<br />stu_color_values:  28.6<br />as.factor(year): 2015<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Public Administration<br />stu_color_values:  14.3<br />as.factor(year): 2015<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Communication Society<br />stu_color_values:    NA<br />as.factor(year): 2015<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Media Studies<br />stu_color_values:  17.4<br />as.factor(year): 2015<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Strategic Communication<br />stu_color_values:   0.0<br />as.factor(year): 2015<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Conflict Dispute Resolution<br />stu_color_values:  18.2<br />as.factor(year): 2015<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Accounting<br />stu_color_values:   0.0<br />as.factor(year): 2015<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Lcb Doctoral<br />stu_color_values:  11.4<br />as.factor(year): 2015<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Mba<br />stu_color_values:   4.2<br />as.factor(year): 2015<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Comparative Literature<br />stu_color_values:  16.7<br />as.factor(year): 2015<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Creative Writing<br />stu_color_values:   9.1<br />as.factor(year): 2015<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): East Asian Lang Lit<br />stu_color_values:   0.0<br />as.factor(year): 2015<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): English<br />stu_color_values:  22.2<br />as.factor(year): 2015<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Folklore<br />stu_color_values:   9.1<br />as.factor(year): 2015<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Linguistics<br />stu_color_values:   6.7<br />as.factor(year): 2015<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Philosophy<br />stu_color_values:   5.0<br />as.factor(year): 2015<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Romance Languages<br />stu_color_values:  10.0<br />as.factor(year): 2015<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Theater Arts<br />stu_color_values:  28.6<br />as.factor(year): 2015<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): German<br />stu_color_values:    NA<br />as.factor(year): 2015<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Biology<br />stu_color_values:   7.3<br />as.factor(year): 2015<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Chemistry<br />stu_color_values:  11.8<br />as.factor(year): 2015<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Computer Information Science<br />stu_color_values:   0.0<br />as.factor(year): 2015<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Geological Sciences<br />stu_color_values:  14.3<br />as.factor(year): 2015<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Human Physiology<br />stu_color_values:   3.6<br />as.factor(year): 2015<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Mathematics<br />stu_color_values:  23.1<br />as.factor(year): 2015<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Physics<br />stu_color_values:  17.4<br />as.factor(year): 2015<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Psychology<br />stu_color_values:  12.7<br />as.factor(year): 2015<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Economics<br />stu_color_values:    NA<br />as.factor(year): 2015<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Environmental Studies<br />stu_color_values:    NA<br />as.factor(year): 2015<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Geography<br />stu_color_values:    NA<br />as.factor(year): 2015<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): History<br />stu_color_values:    NA<br />as.factor(year): 2015<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): International Studies<br />stu_color_values:    NA<br />as.factor(year): 2015<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Political Science<br />stu_color_values:    NA<br />as.factor(year): 2015<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Sociology<br />stu_color_values:    NA<br />as.factor(year): 2015<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Communication Disorder Sciences<br />stu_color_values:  13.0<br />as.factor(year): 2015<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Counseling Psychology<br />stu_color_values:   5.7<br />as.factor(year): 2015<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Counseling Family Human Services<br />stu_color_values:   0.0<br />as.factor(year): 2015<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Couples Family Therapy<br />stu_color_values:   6.3<br />as.factor(year): 2015<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Critical Cultural Studies Ed<br />stu_color_values:  25.0<br />as.factor(year): 2015<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Curriculum Teaching<br />stu_color_values:   6.3<br />as.factor(year): 2015<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Educational Meth Policy Lead<br />stu_color_values:  11.8<br />as.factor(year): 2015<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): School Psychology<br />stu_color_values:   6.3<br />as.factor(year): 2015<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color","fct_reorder(program, stu_color_values): Special Education<br />stu_color_values:  17.6<br />as.factor(year): 2015<br />as.factor(stu_color): Disagree with Inclusive Environment for Students of Color"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(102,155,62,1)","opacity":1,"size":7.55905511811024,"symbol":"triangle-up","line":{"width":1.88976377952756,"color":"rgba(102,155,62,1)"}},"hoveron":"points","name":"(2015,Disagree with Inclusive Environment for Students of Color)","legendgroup":"(2015,Disagree with Inclusive Environment for Students of Color)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.7625570776256,"r":7.30593607305936,"b":40.1826484018265,"l":197.990867579909},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"title":{"text":"Faculty Quality by Academic Program","font":{"color":"rgba(0,0,0,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-5,105],"tickmode":"array","ticktext":["0","25","50","75","100"],"tickvals":[0,25,50,75,100],"categoryorder":"array","categoryarray":["0","25","50","75","100"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"Faculty Quality","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.4,53.6],"tickmode":"array","ticktext":["Critical Cultural Studies Ed","Art History","Community Regional Planning","Counseling Family Human Services","Art","English","Human Physiology","Geological Sciences","Mba","Anthropology","Communication Disorder Sciences","Philosophy","Psychology","Folklore","Computer Information Science","Strategic Communication","Physics","Architecture","Educational Meth Policy Lead","Mathematics","Music","Nonprofit Management","Biology","Public Administration","Curriculum Teaching","Arts Management","Romance Languages","Accounting","Conflict Dispute Resolution","Creative Writing","Landscape Architecture","Lcb Doctoral","School Psychology","Comparative Literature","Chemistry","Special Education","Theater Arts","Media Studies","Couples Family Therapy","East Asian Lang Lit","Linguistics","Counseling Psychology","Interior Architecture","Communication Society","Economics","Environmental Studies","Geography","German","Historic Preservation","History","International Studies","Political Science","Sociology"],"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53],"categoryorder":"array","categoryarray":["Critical Cultural Studies Ed","Art History","Community Regional Planning","Counseling Family Human Services","Art","English","Human Physiology","Geological Sciences","Mba","Anthropology","Communication Disorder Sciences","Philosophy","Psychology","Folklore","Computer Information Science","Strategic Communication","Physics","Architecture","Educational Meth Policy Lead","Mathematics","Music","Nonprofit Management","Biology","Public Administration","Curriculum Teaching","Arts Management","Romance Languages","Accounting","Conflict Dispute Resolution","Creative Writing","Landscape Architecture","Lcb Doctoral","School Psychology","Comparative Literature","Chemistry","Special Education","Theater Arts","Media Studies","Couples Family Therapy","East Asian Lang Lit","Linguistics","Counseling Psychology","Interior Architecture","Communication Society","Economics","Environmental Studies","Geography","German","Historic Preservation","History","International Studies","Political Science","Sociology"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"title":{"text":"as.factor(stu_color)<br />as.factor(year)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"3714984ce3":{"x":{},"y":{},"colour":{},"shape":{},"type":"scatter"}},"cur_data":"3714984ce3","visdat":{"3714984ce3":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div class="sourceCode cell-code" id="cb40" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1">firstgen <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> exit <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb40-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> tidyselect<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vars_select</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(exit), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">starts_with</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"inclu_first_gen"</span>)),</span>
<span id="cb40-3">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"first_gen"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"first_gen_values"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb40-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(first_gen <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"inclu_first_gen_strong"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb40-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">first_gen =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">recode</span>(first_gen, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"inclu_first_gen_agree"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Agree with Inclusive Environment for First Gen"</span>,</span>
<span id="cb40-6">                           <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"inclu_first_gen_disagree"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Disagree with Inclusive Environment for First Gen"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb40-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_reorder</span>(program, first_gen_values), first_gen_values)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb40-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(year), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">shape =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(first_gen)), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb40-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Faculty Quality by Academic Program"</span>,</span>
<span id="cb40-10">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>,</span>
<span id="cb40-11">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Faculty Quality"</span>,</span>
<span id="cb40-12">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Data from University of Oregon's (UO)</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">student satisfaction surveys after graduation"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb40-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_flip</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb40-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#d74122"</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#669b3e"</span>))</span>
<span id="cb40-15"></span>
<span id="cb40-16">first_plot <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplotly</span>(firstgen) </span>
<span id="cb40-17">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># layout(legend = list(orientation = "h",</span></span>
<span id="cb40-18">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#                      xanchor = "center",</span></span>
<span id="cb40-19">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#                      x = 0,</span></span>
<span id="cb40-20">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#                      y = -60)) </span></span>
<span id="cb40-21">first_plot</span></code></pre></div>
<div class="cell-output-display">
<div id="htmlwidget-4e783cecca3dcafea624" style="width:100%;height:464px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-4e783cecca3dcafea624">{"x":{"data":[{"x":[96,58.7,76.5,90.9,65.4,36,63.6,71.4,82.8,71.4,52.6,41.7,12.5,62.1,81.8,73.3,60.5,90.9,70,84.6,54,77.8,100,84,65.2,92.3,28.6,74.5,72.5,66.7,59.3,62.5,69,63.6,62.5,60,73.7,80,75,43.8,94.4,42,53.8,76.9,72.7,87.1,70,92.3,67.4,50,78],"y":[39,17,18,2,19,1,49,6,43,37,32,44,4,25,42,21,12,3,34,35,11,13,48,38,30,24,8,26,31,14,15,16,28,5,22,27,45,46,47,50,51,52,53,20,29,40,36,41,33,9,23],"text":["fct_reorder(program, first_gen_values): Music<br />first_gen_values:  96.0<br />as.factor(year): 2012<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Architecture<br />first_gen_values:  58.7<br />as.factor(year): 2012<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Art<br />first_gen_values:  76.5<br />as.factor(year): 2012<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Art History<br />first_gen_values:  90.9<br />as.factor(year): 2012<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Arts Management<br />first_gen_values:  65.4<br />as.factor(year): 2012<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Community Regional Planning<br />first_gen_values:  36.0<br />as.factor(year): 2012<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Historic Preservation<br />first_gen_values:  63.6<br />as.factor(year): 2012<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Interior Architecture<br />first_gen_values:  71.4<br />as.factor(year): 2012<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Landscape Architecture<br />first_gen_values:  82.8<br />as.factor(year): 2012<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Nonprofit Management<br />first_gen_values:  71.4<br />as.factor(year): 2012<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Public Administration<br />first_gen_values:  52.6<br />as.factor(year): 2012<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Communication Society<br />first_gen_values:  41.7<br />as.factor(year): 2012<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Strategic Communication<br />first_gen_values:  12.5<br />as.factor(year): 2012<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Conflict Dispute Resolution<br />first_gen_values:  62.1<br />as.factor(year): 2012<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Accounting<br />first_gen_values:  81.8<br />as.factor(year): 2012<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Lcb Doctoral<br />first_gen_values:  73.3<br />as.factor(year): 2012<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Mba<br />first_gen_values:  60.5<br />as.factor(year): 2012<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Comparative Literature<br />first_gen_values:  90.9<br />as.factor(year): 2012<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Creative Writing<br />first_gen_values:  70.0<br />as.factor(year): 2012<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): East Asian Lang Lit<br />first_gen_values:  84.6<br />as.factor(year): 2012<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): English<br />first_gen_values:  54.0<br />as.factor(year): 2012<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Folklore<br />first_gen_values:  77.8<br />as.factor(year): 2012<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): German<br />first_gen_values: 100.0<br />as.factor(year): 2012<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Linguistics<br />first_gen_values:  84.0<br />as.factor(year): 2012<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Philosophy<br />first_gen_values:  65.2<br />as.factor(year): 2012<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Romance Languages<br />first_gen_values:  92.3<br />as.factor(year): 2012<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Theater Arts<br />first_gen_values:  28.6<br />as.factor(year): 2012<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Biology<br />first_gen_values:  74.5<br />as.factor(year): 2012<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Chemistry<br />first_gen_values:  72.5<br />as.factor(year): 2012<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Computer Information Science<br />first_gen_values:  66.7<br />as.factor(year): 2012<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Geological Sciences<br />first_gen_values:  59.3<br />as.factor(year): 2012<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Human Physiology<br />first_gen_values:  62.5<br />as.factor(year): 2012<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Mathematics<br />first_gen_values:  69.0<br />as.factor(year): 2012<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Physics<br />first_gen_values:  63.6<br />as.factor(year): 2012<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Psychology<br />first_gen_values:  62.5<br />as.factor(year): 2012<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Anthropology<br />first_gen_values:  60.0<br />as.factor(year): 2012<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Economics<br />first_gen_values:  73.7<br />as.factor(year): 2012<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Environmental Studies<br />first_gen_values:  80.0<br />as.factor(year): 2012<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Geography<br />first_gen_values:  75.0<br />as.factor(year): 2012<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): History<br />first_gen_values:  43.8<br />as.factor(year): 2012<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): International Studies<br />first_gen_values:  94.4<br />as.factor(year): 2012<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Political Science<br />first_gen_values:  42.0<br />as.factor(year): 2012<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Sociology<br />first_gen_values:  53.8<br />as.factor(year): 2012<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Communication Disorder Sciences<br />first_gen_values:  76.9<br />as.factor(year): 2012<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Counseling Psychology<br />first_gen_values:  72.7<br />as.factor(year): 2012<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Couples Family Therapy<br />first_gen_values:  87.1<br />as.factor(year): 2012<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Critical Cultural Studies Ed<br />first_gen_values:  70.0<br />as.factor(year): 2012<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Curriculum Teaching<br />first_gen_values:  92.3<br />as.factor(year): 2012<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Educational Meth Policy Lead<br />first_gen_values:  67.4<br />as.factor(year): 2012<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): School Psychology<br />first_gen_values:  50.0<br />as.factor(year): 2012<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Special Education<br />first_gen_values:  78.0<br />as.factor(year): 2012<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(215,65,34,1)","opacity":1,"size":7.55905511811024,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(215,65,34,1)"}},"hoveron":"points","name":"(2012,Agree with Inclusive Environment for First Gen)","legendgroup":"(2012,Agree with Inclusive Environment for First Gen)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[4,9.3,5.9,0,7.7,12,18.2,0,10.3,0,26.3,12.5,37.5,17.2,9.1,0,2.6,0,10,0,11.1,0,0,4,13,3.8,28.6,6.4,3.9,0,7.4,4.2,6.9,6.8,8.9,15,0,0,4.2,12.5,0,26.7,23.1,3.8,4.5,0,0,7.7,11.6,8.3,4.9],"y":[39,17,18,2,19,1,49,6,43,37,32,44,4,25,42,21,12,3,34,35,11,13,48,38,30,24,8,26,31,14,15,16,28,5,22,27,45,46,47,50,51,52,53,20,29,40,36,41,33,9,23],"text":["fct_reorder(program, first_gen_values): Music<br />first_gen_values:   4.0<br />as.factor(year): 2012<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Architecture<br />first_gen_values:   9.3<br />as.factor(year): 2012<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Art<br />first_gen_values:   5.9<br />as.factor(year): 2012<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Art History<br />first_gen_values:   0.0<br />as.factor(year): 2012<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Arts Management<br />first_gen_values:   7.7<br />as.factor(year): 2012<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Community Regional Planning<br />first_gen_values:  12.0<br />as.factor(year): 2012<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Historic Preservation<br />first_gen_values:  18.2<br />as.factor(year): 2012<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Interior Architecture<br />first_gen_values:   0.0<br />as.factor(year): 2012<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Landscape Architecture<br />first_gen_values:  10.3<br />as.factor(year): 2012<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Nonprofit Management<br />first_gen_values:   0.0<br />as.factor(year): 2012<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Public Administration<br />first_gen_values:  26.3<br />as.factor(year): 2012<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Communication Society<br />first_gen_values:  12.5<br />as.factor(year): 2012<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Strategic Communication<br />first_gen_values:  37.5<br />as.factor(year): 2012<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Conflict Dispute Resolution<br />first_gen_values:  17.2<br />as.factor(year): 2012<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Accounting<br />first_gen_values:   9.1<br />as.factor(year): 2012<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Lcb Doctoral<br />first_gen_values:   0.0<br />as.factor(year): 2012<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Mba<br />first_gen_values:   2.6<br />as.factor(year): 2012<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Comparative Literature<br />first_gen_values:   0.0<br />as.factor(year): 2012<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Creative Writing<br />first_gen_values:  10.0<br />as.factor(year): 2012<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): East Asian Lang Lit<br />first_gen_values:   0.0<br />as.factor(year): 2012<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): English<br />first_gen_values:  11.1<br />as.factor(year): 2012<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Folklore<br />first_gen_values:   0.0<br />as.factor(year): 2012<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): German<br />first_gen_values:   0.0<br />as.factor(year): 2012<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Linguistics<br />first_gen_values:   4.0<br />as.factor(year): 2012<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Philosophy<br />first_gen_values:  13.0<br />as.factor(year): 2012<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Romance Languages<br />first_gen_values:   3.8<br />as.factor(year): 2012<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Theater Arts<br />first_gen_values:  28.6<br />as.factor(year): 2012<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Biology<br />first_gen_values:   6.4<br />as.factor(year): 2012<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Chemistry<br />first_gen_values:   3.9<br />as.factor(year): 2012<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Computer Information Science<br />first_gen_values:   0.0<br />as.factor(year): 2012<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Geological Sciences<br />first_gen_values:   7.4<br />as.factor(year): 2012<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Human Physiology<br />first_gen_values:   4.2<br />as.factor(year): 2012<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Mathematics<br />first_gen_values:   6.9<br />as.factor(year): 2012<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Physics<br />first_gen_values:   6.8<br />as.factor(year): 2012<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Psychology<br />first_gen_values:   8.9<br />as.factor(year): 2012<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Anthropology<br />first_gen_values:  15.0<br />as.factor(year): 2012<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Economics<br />first_gen_values:   0.0<br />as.factor(year): 2012<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Environmental Studies<br />first_gen_values:   0.0<br />as.factor(year): 2012<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Geography<br />first_gen_values:   4.2<br />as.factor(year): 2012<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): History<br />first_gen_values:  12.5<br />as.factor(year): 2012<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): International Studies<br />first_gen_values:   0.0<br />as.factor(year): 2012<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Political Science<br />first_gen_values:  26.7<br />as.factor(year): 2012<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Sociology<br />first_gen_values:  23.1<br />as.factor(year): 2012<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Communication Disorder Sciences<br />first_gen_values:   3.8<br />as.factor(year): 2012<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Counseling Psychology<br />first_gen_values:   4.5<br />as.factor(year): 2012<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Couples Family Therapy<br />first_gen_values:   0.0<br />as.factor(year): 2012<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Critical Cultural Studies Ed<br />first_gen_values:   0.0<br />as.factor(year): 2012<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Curriculum Teaching<br />first_gen_values:   7.7<br />as.factor(year): 2012<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Educational Meth Policy Lead<br />first_gen_values:  11.6<br />as.factor(year): 2012<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): School Psychology<br />first_gen_values:   8.3<br />as.factor(year): 2012<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Special Education<br />first_gen_values:   4.9<br />as.factor(year): 2012<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(215,65,34,1)","opacity":1,"size":7.55905511811024,"symbol":"triangle-up","line":{"width":1.88976377952756,"color":"rgba(215,65,34,1)"}},"hoveron":"points","name":"(2012,Disagree with Inclusive Environment for First Gen)","legendgroup":"(2012,Disagree with Inclusive Environment for First Gen)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[77.8,76.4,62.5,33.3,56.3,53.3,null,57.1,92.9,64.3,64.3,null,47.6,66.7,57.1,92.9,67.6,83.3,50,70,80,46.7,63.6,82.1,80,52.6,57.1,null,68.3,73.5,80,81,89.3,80.8,41.9,50.9,null,null,null,null,null,null,null,60.9,77.1,60,87.5,36.4,81.3,68.8,75,64.7],"y":[39,17,18,2,19,1,49,6,43,37,32,44,7,4,25,42,21,12,3,34,35,11,13,38,30,24,8,48,26,31,14,15,16,28,5,22,45,46,47,50,51,52,53,20,29,10,40,36,41,33,9,23],"text":["fct_reorder(program, first_gen_values): Music<br />first_gen_values:  77.8<br />as.factor(year): 2015<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Architecture<br />first_gen_values:  76.4<br />as.factor(year): 2015<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Art<br />first_gen_values:  62.5<br />as.factor(year): 2015<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Art History<br />first_gen_values:  33.3<br />as.factor(year): 2015<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Arts Management<br />first_gen_values:  56.3<br />as.factor(year): 2015<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Community Regional Planning<br />first_gen_values:  53.3<br />as.factor(year): 2015<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Historic Preservation<br />first_gen_values:    NA<br />as.factor(year): 2015<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Interior Architecture<br />first_gen_values:  57.1<br />as.factor(year): 2015<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Landscape Architecture<br />first_gen_values:  92.9<br />as.factor(year): 2015<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Nonprofit Management<br />first_gen_values:  64.3<br />as.factor(year): 2015<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Public Administration<br />first_gen_values:  64.3<br />as.factor(year): 2015<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Communication Society<br />first_gen_values:    NA<br />as.factor(year): 2015<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Media Studies<br />first_gen_values:  47.6<br />as.factor(year): 2015<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Strategic Communication<br />first_gen_values:  66.7<br />as.factor(year): 2015<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Conflict Dispute Resolution<br />first_gen_values:  57.1<br />as.factor(year): 2015<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Accounting<br />first_gen_values:  92.9<br />as.factor(year): 2015<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Lcb Doctoral<br />first_gen_values:  67.6<br />as.factor(year): 2015<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Mba<br />first_gen_values:  83.3<br />as.factor(year): 2015<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Comparative Literature<br />first_gen_values:  50.0<br />as.factor(year): 2015<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Creative Writing<br />first_gen_values:  70.0<br />as.factor(year): 2015<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): East Asian Lang Lit<br />first_gen_values:  80.0<br />as.factor(year): 2015<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): English<br />first_gen_values:  46.7<br />as.factor(year): 2015<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Folklore<br />first_gen_values:  63.6<br />as.factor(year): 2015<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Linguistics<br />first_gen_values:  82.1<br />as.factor(year): 2015<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Philosophy<br />first_gen_values:  80.0<br />as.factor(year): 2015<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Romance Languages<br />first_gen_values:  52.6<br />as.factor(year): 2015<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Theater Arts<br />first_gen_values:  57.1<br />as.factor(year): 2015<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): German<br />first_gen_values:    NA<br />as.factor(year): 2015<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Biology<br />first_gen_values:  68.3<br />as.factor(year): 2015<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Chemistry<br />first_gen_values:  73.5<br />as.factor(year): 2015<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Computer Information Science<br />first_gen_values:  80.0<br />as.factor(year): 2015<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Geological Sciences<br />first_gen_values:  81.0<br />as.factor(year): 2015<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Human Physiology<br />first_gen_values:  89.3<br />as.factor(year): 2015<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Mathematics<br />first_gen_values:  80.8<br />as.factor(year): 2015<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Physics<br />first_gen_values:  41.9<br />as.factor(year): 2015<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Psychology<br />first_gen_values:  50.9<br />as.factor(year): 2015<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Economics<br />first_gen_values:    NA<br />as.factor(year): 2015<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Environmental Studies<br />first_gen_values:    NA<br />as.factor(year): 2015<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Geography<br />first_gen_values:    NA<br />as.factor(year): 2015<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): History<br />first_gen_values:    NA<br />as.factor(year): 2015<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): International Studies<br />first_gen_values:    NA<br />as.factor(year): 2015<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Political Science<br />first_gen_values:    NA<br />as.factor(year): 2015<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Sociology<br />first_gen_values:    NA<br />as.factor(year): 2015<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Communication Disorder Sciences<br />first_gen_values:  60.9<br />as.factor(year): 2015<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Counseling Psychology<br />first_gen_values:  77.1<br />as.factor(year): 2015<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Counseling Family Human Services<br />first_gen_values:  60.0<br />as.factor(year): 2015<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Couples Family Therapy<br />first_gen_values:  87.5<br />as.factor(year): 2015<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Critical Cultural Studies Ed<br />first_gen_values:  36.4<br />as.factor(year): 2015<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Curriculum Teaching<br />first_gen_values:  81.3<br />as.factor(year): 2015<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Educational Meth Policy Lead<br />first_gen_values:  68.8<br />as.factor(year): 2015<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): School Psychology<br />first_gen_values:  75.0<br />as.factor(year): 2015<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Special Education<br />first_gen_values:  64.7<br />as.factor(year): 2015<br />as.factor(first_gen): Agree with Inclusive Environment for First Gen"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(102,155,62,1)","opacity":1,"size":7.55905511811024,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(102,155,62,1)"}},"hoveron":"points","name":"(2015,Agree with Inclusive Environment for First Gen)","legendgroup":"(2015,Agree with Inclusive Environment for First Gen)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[8.6,0,0,16.7,12.5,6.7,null,0,0,21.4,7.1,null,9.5,11.1,4.8,0,2.9,0,0,0,0,13.3,0,3.6,0,21.1,28.6,null,4.9,5.9,0,4.8,0,0,14,20,null,null,null,null,null,null,null,8.7,2.9,0,0,45.5,0,6.3,6.3,8.8],"y":[39,17,18,2,19,1,49,6,43,37,32,44,7,4,25,42,21,12,3,34,35,11,13,38,30,24,8,48,26,31,14,15,16,28,5,22,45,46,47,50,51,52,53,20,29,10,40,36,41,33,9,23],"text":["fct_reorder(program, first_gen_values): Music<br />first_gen_values:   8.6<br />as.factor(year): 2015<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Architecture<br />first_gen_values:   0.0<br />as.factor(year): 2015<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Art<br />first_gen_values:   0.0<br />as.factor(year): 2015<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Art History<br />first_gen_values:  16.7<br />as.factor(year): 2015<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Arts Management<br />first_gen_values:  12.5<br />as.factor(year): 2015<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Community Regional Planning<br />first_gen_values:   6.7<br />as.factor(year): 2015<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Historic Preservation<br />first_gen_values:    NA<br />as.factor(year): 2015<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Interior Architecture<br />first_gen_values:   0.0<br />as.factor(year): 2015<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Landscape Architecture<br />first_gen_values:   0.0<br />as.factor(year): 2015<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Nonprofit Management<br />first_gen_values:  21.4<br />as.factor(year): 2015<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Public Administration<br />first_gen_values:   7.1<br />as.factor(year): 2015<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Communication Society<br />first_gen_values:    NA<br />as.factor(year): 2015<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Media Studies<br />first_gen_values:   9.5<br />as.factor(year): 2015<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Strategic Communication<br />first_gen_values:  11.1<br />as.factor(year): 2015<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Conflict Dispute Resolution<br />first_gen_values:   4.8<br />as.factor(year): 2015<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Accounting<br />first_gen_values:   0.0<br />as.factor(year): 2015<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Lcb Doctoral<br />first_gen_values:   2.9<br />as.factor(year): 2015<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Mba<br />first_gen_values:   0.0<br />as.factor(year): 2015<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Comparative Literature<br />first_gen_values:   0.0<br />as.factor(year): 2015<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Creative Writing<br />first_gen_values:   0.0<br />as.factor(year): 2015<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): East Asian Lang Lit<br />first_gen_values:   0.0<br />as.factor(year): 2015<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): English<br />first_gen_values:  13.3<br />as.factor(year): 2015<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Folklore<br />first_gen_values:   0.0<br />as.factor(year): 2015<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Linguistics<br />first_gen_values:   3.6<br />as.factor(year): 2015<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Philosophy<br />first_gen_values:   0.0<br />as.factor(year): 2015<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Romance Languages<br />first_gen_values:  21.1<br />as.factor(year): 2015<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Theater Arts<br />first_gen_values:  28.6<br />as.factor(year): 2015<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): German<br />first_gen_values:    NA<br />as.factor(year): 2015<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Biology<br />first_gen_values:   4.9<br />as.factor(year): 2015<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Chemistry<br />first_gen_values:   5.9<br />as.factor(year): 2015<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Computer Information Science<br />first_gen_values:   0.0<br />as.factor(year): 2015<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Geological Sciences<br />first_gen_values:   4.8<br />as.factor(year): 2015<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Human Physiology<br />first_gen_values:   0.0<br />as.factor(year): 2015<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Mathematics<br />first_gen_values:   0.0<br />as.factor(year): 2015<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Physics<br />first_gen_values:  14.0<br />as.factor(year): 2015<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Psychology<br />first_gen_values:  20.0<br />as.factor(year): 2015<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Economics<br />first_gen_values:    NA<br />as.factor(year): 2015<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Environmental Studies<br />first_gen_values:    NA<br />as.factor(year): 2015<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Geography<br />first_gen_values:    NA<br />as.factor(year): 2015<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): History<br />first_gen_values:    NA<br />as.factor(year): 2015<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): International Studies<br />first_gen_values:    NA<br />as.factor(year): 2015<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Political Science<br />first_gen_values:    NA<br />as.factor(year): 2015<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Sociology<br />first_gen_values:    NA<br />as.factor(year): 2015<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Communication Disorder Sciences<br />first_gen_values:   8.7<br />as.factor(year): 2015<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Counseling Psychology<br />first_gen_values:   2.9<br />as.factor(year): 2015<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Counseling Family Human Services<br />first_gen_values:   0.0<br />as.factor(year): 2015<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Couples Family Therapy<br />first_gen_values:   0.0<br />as.factor(year): 2015<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Critical Cultural Studies Ed<br />first_gen_values:  45.5<br />as.factor(year): 2015<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Curriculum Teaching<br />first_gen_values:   0.0<br />as.factor(year): 2015<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Educational Meth Policy Lead<br />first_gen_values:   6.3<br />as.factor(year): 2015<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): School Psychology<br />first_gen_values:   6.3<br />as.factor(year): 2015<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen","fct_reorder(program, first_gen_values): Special Education<br />first_gen_values:   8.8<br />as.factor(year): 2015<br />as.factor(first_gen): Disagree with Inclusive Environment for First Gen"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(102,155,62,1)","opacity":1,"size":7.55905511811024,"symbol":"triangle-up","line":{"width":1.88976377952756,"color":"rgba(102,155,62,1)"}},"hoveron":"points","name":"(2015,Disagree with Inclusive Environment for First Gen)","legendgroup":"(2015,Disagree with Inclusive Environment for First Gen)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.7625570776256,"r":7.30593607305936,"b":40.1826484018265,"l":197.990867579909},"font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"title":{"text":"Faculty Quality by Academic Program","font":{"color":"rgba(0,0,0,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-5,105],"tickmode":"array","ticktext":["0","25","50","75","100"],"tickvals":[0,25,50,75,100],"categoryorder":"array","categoryarray":["0","25","50","75","100"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"Faculty Quality","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[0.4,53.6],"tickmode":"array","ticktext":["Community Regional Planning","Art History","Comparative Literature","Strategic Communication","Physics","Interior Architecture","Media Studies","Theater Arts","School Psychology","Counseling Family Human Services","English","Mba","Folklore","Computer Information Science","Geological Sciences","Human Physiology","Architecture","Art","Arts Management","Communication Disorder Sciences","Lcb Doctoral","Psychology","Special Education","Romance Languages","Conflict Dispute Resolution","Biology","Anthropology","Mathematics","Counseling Psychology","Philosophy","Chemistry","Public Administration","Educational Meth Policy Lead","Creative Writing","East Asian Lang Lit","Critical Cultural Studies Ed","Nonprofit Management","Linguistics","Music","Couples Family Therapy","Curriculum Teaching","Accounting","Landscape Architecture","Communication Society","Economics","Environmental Studies","Geography","German","Historic Preservation","History","International Studies","Political Science","Sociology"],"tickvals":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53],"categoryorder":"array","categoryarray":["Community Regional Planning","Art History","Comparative Literature","Strategic Communication","Physics","Interior Architecture","Media Studies","Theater Arts","School Psychology","Counseling Family Human Services","English","Mba","Folklore","Computer Information Science","Geological Sciences","Human Physiology","Architecture","Art","Arts Management","Communication Disorder Sciences","Lcb Doctoral","Psychology","Special Education","Romance Languages","Conflict Dispute Resolution","Biology","Anthropology","Mathematics","Counseling Psychology","Philosophy","Chemistry","Public Administration","Educational Meth Policy Lead","Creative Writing","East Asian Lang Lit","Critical Cultural Studies Ed","Nonprofit Management","Linguistics","Music","Couples Family Therapy","Curriculum Teaching","Accounting","Landscape Architecture","Communication Society","Economics","Environmental Studies","Geography","German","Historic Preservation","History","International Studies","Political Science","Sociology"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(235,235,235,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":true,"legend":{"bgcolor":null,"bordercolor":null,"borderwidth":0,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"title":{"text":"as.factor(year)<br />as.factor(first_gen)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"371451d34afa":{"x":{},"y":{},"colour":{},"shape":{},"type":"scatter"}},"cur_data":"371451d34afa","visdat":{"371451d34afa":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>



 ]]></description>
  <category>Visualizations</category>
  <category>Shiny</category>
  <guid>https://log-of-jandp.com/posts/2021-04-30-grad-student-exit-surveys/index.html</guid>
  <pubDate>Sat, 19 Jun 2021 07:00:00 GMT</pubDate>
  <media:content url="https://log-of-jandp.com/posts/2021-04-30-grad-student-exit-surveys/upset_lego.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Tidy Tuesday Coffee Ratings</title>
  <link>https://log-of-jandp.com/posts/2021-05-13-tidy-tuesday-coffee-ratings/index.html</link>
  <description><![CDATA[ 




<section id="predicting-process-of-green-coffee-beans" class="level2">
<h2 class="anchored" data-anchor-id="predicting-process-of-green-coffee-beans">Predicting Process of Green Coffee Beans</h2>
<p>With coffee being a hobby of mine, I was scrolling through past Tidy Tuesdays and found one on coffee ratings. Originally I thought looking at predictions of total cup points, but I assumed with all the coffee tasting characteristics that it wouldn’t really tell me anything. Instead, I decided to look into the processing method, as there are different taste characteristics between washed and other processing methods.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">coffee <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">read_csv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-07-07/coffee_ratings.csv'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">species =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(species),</span>
<span id="cb1-3">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">process =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">recode</span>(processing_method, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Washed / Wet"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"washed"</span>,</span>
<span id="cb1-4">                          <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Semi-washed / Semi-pulped"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"not_washed"</span>,</span>
<span id="cb1-5">                          <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Pulped natural / honey"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"not_washed"</span>,</span>
<span id="cb1-6">                          <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Other"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"not_washed"</span>,</span>
<span id="cb1-7">                          <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Natural / Dry"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"not_washed"</span>,</span>
<span id="cb1-8">                          <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"NA"</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA_character_</span>),</span>
<span id="cb1-9">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">process =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(process),</span>
<span id="cb1-10">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">process =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">relevel</span>(process, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ref =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"washed"</span>),</span>
<span id="cb1-11">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">country_of_origin =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(country_of_origin)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">drop_na</span>(process) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb1-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(country_of_origin <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Cote d?Ivoire"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 1339 Columns: 43
-- Column specification --------------------------------------------------------
Delimiter: ","
chr (24): species, owner, country_of_origin, farm_name, lot_number, mill, ic...
dbl (19): total_cup_points, number_of_bags, aroma, flavor, aftertaste, acidi...

i Use `spec()` to retrieve the full column specification for this data.
i Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<p>After looking at the distributions of procssing methods, I also decided to make the processing method binary with washed and not washed. This worked out better for the prediction models. There are also some descriptives of each variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">coffee <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(processing_method)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_bar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dodgerblue"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_flip</span>()</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://log-of-jandp.com/posts/2021-05-13-tidy-tuesday-coffee-ratings/index_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">coffee <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb4-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(process)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_bar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"dodgerblue"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_flip</span>()</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://log-of-jandp.com/posts/2021-05-13-tidy-tuesday-coffee-ratings/index_files/figure-html/unnamed-chunk-1-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">psych<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">describe</span>(coffee, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">na.rm =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"n"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mean"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sd"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"min"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"max"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"skew"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"kurtosis"</span>)]</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                          n    mean      sd   min       max  skew kurtosis
total_cup_points       1168   82.06    2.71 59.83     90.58 -1.95     9.26
species*               1168    1.01    0.09  1.00      2.00 10.65   111.61
owner*                 1161  133.43   76.78  1.00    287.00  0.10    -1.00
country_of_origin*     1168   14.79   10.08  1.00     36.00  0.31    -1.12
farm_name*              883  271.04  154.16  1.00    524.00  0.00    -1.27
lot_number*             239   93.18   59.86  1.00    202.00  0.18    -1.27
mill*                   931  196.60  122.71  1.00    419.00  0.24    -1.28
ico_number*            1057  360.89  242.05  1.00    753.00  0.08    -1.27
company*               1077  141.73   76.77  1.00    266.00 -0.10    -1.23
altitude*              1014  154.54   98.40  1.00    351.00  0.32    -1.04
region*                1137  174.91   87.74  1.00    325.00 -0.11    -1.09
producer*               995  314.12  175.27  1.00    624.00 -0.04    -1.12
number_of_bags         1168  153.80  130.08  1.00   1062.00  0.37     0.50
bag_weight*            1168   23.50   16.67  1.00     45.00 -0.23    -1.71
in_country_partner*    1168    9.68    7.04  1.00     25.00  0.41    -1.31
harvest_year*          1161    5.82    2.95  1.00     14.00  0.76    -0.46
grading_date*          1168  242.39  144.52  1.00    495.00  0.11    -1.21
owner_1*               1161  135.29   77.68  1.00    290.00  0.09    -1.00
variety*               1089   12.61    9.77  1.00     29.00  0.63    -1.24
processing_method*     1168    3.98    1.67  1.00      5.00 -1.13    -0.62
aroma                  1168    7.56    0.31  5.08      8.75 -0.55     4.46
flavor                 1168    7.51    0.34  6.08      8.83 -0.34     1.73
aftertaste             1168    7.39    0.34  6.17      8.67 -0.45     1.36
acidity                1168    7.53    0.31  5.25      8.75 -0.30     3.31
body                   1168    7.52    0.28  6.33      8.50 -0.10     0.89
balance                1168    7.51    0.34  6.08      8.58 -0.10     1.17
uniformity             1168    9.84    0.50  6.00     10.00 -4.21    20.83
clean_cup              1168    9.84    0.75  0.00     10.00 -6.98    62.29
sweetness              1168    9.89    0.52  1.33     10.00 -7.53    80.78
cupper_points          1168    7.48    0.40  5.17      8.75 -0.64     2.79
moisture               1168    0.09    0.05  0.00      0.17 -1.41     0.35
category_one_defects   1168    0.51    2.70  0.00     63.00 14.43   279.42
quakers                1167    0.17    0.82  0.00     11.00  6.87    57.30
color*                 1070    2.80    0.64  1.00      4.00 -1.51     2.57
category_two_defects   1168    3.79    5.54  0.00     55.00  3.54    18.53
expiration*            1168  241.61  144.11  1.00    494.00  0.12    -1.21
certification_body*    1168    9.38    6.65  1.00     24.00  0.37    -1.31
certification_address* 1168   16.58    7.33  1.00     29.00 -0.19    -1.06
certification_contact* 1168    9.39    7.26  1.00     26.00  0.36    -0.96
unit_of_measurement*   1168    1.87    0.34  1.00      2.00 -2.21     2.87
altitude_low_meters    1012 1796.86 9073.21  1.00 190164.00 19.36   384.12
altitude_high_meters   1012 1834.27 9071.86  1.00 190164.00 19.36   384.03
altitude_mean_meters   1012 1815.56 9072.31  1.00 190164.00 19.36   384.12
process*               1168    1.30    0.46  1.00      2.00  0.86    -1.27</code></pre>
</div>
</div>
<p>Now, its time to split the data into training and testing data. I also included the function of <code>strata</code> to stratify sampling based on process.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">05132021</span>)</span>
<span id="cb7-2"></span>
<span id="cb7-3">coffee_split <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">initial_split</span>(coffee, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">strata =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"process"</span>)</span>
<span id="cb7-4"></span>
<span id="cb7-5">coffee_train <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">training</span>(coffee_split)</span>
<span id="cb7-6">coffee_test <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">testing</span>(coffee_split)</span></code></pre></div>
</div>
<p>I also did some cross validation for the training dataset and used the metrics I was most interested in.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">05132021</span>)</span>
<span id="cb8-2"></span>
<span id="cb8-3">coffee_fold <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vfold_cv</span>(coffee_train, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">strata =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"process"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">v =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb8-4"></span>
<span id="cb8-5">metric_measure <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">metric_set</span>(accuracy, mn_log_loss, roc_auc)</span></code></pre></div>
</div>
<p>From the beginning I was interested in the tasting characteristics and how they would predict whether the green coffee was washed or not washed. I also included the total cup points because I wanted to see the importance of that predictor on the processing method. The only feature engineering I did was to remove any zero variance in the predictors of the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">05132021</span>)</span>
<span id="cb9-2"></span>
<span id="cb9-3">char_recipe <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">recipe</span>(process <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> aroma <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> flavor <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> aftertaste <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-4">                        acidity <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> body <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> balance <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> uniformity <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> clean_cup <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-5">                        sweetness <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> total_cup_points,</span>
<span id="cb9-6">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> coffee_train) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb9-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">step_zv</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">all_predictors</span>(), <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">all_outcomes</span>())</span>
<span id="cb9-8"></span>
<span id="cb9-9">char_recipe <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb9-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">prep</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb9-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bake</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">new_data =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb9-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 x 11
  aroma flavor aftertaste acidity  body balance unifor~1 clean~2 sweet~3 total~4
  &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
1  8.17   8.58       8.42    8.42  8.5     8.25       10      10      10    89  
2  8.08   8.58       8.5     8.5   7.67    8.42       10      10      10    88.2
3  8.17   8.17       8       8.17  8.08    8.33       10      10      10    87.2
4  8.42   8.17       7.92    8.17  8.33    8          10      10      10    87.1
5  8.5    8.5        8       8     8       8          10      10      10    86.9
6  8      8          8       8.25  8       8.17       10      10      10    86.6
# ... with 1 more variable: process &lt;fct&gt;, and abbreviated variable names
#   1: uniformity, 2: clean_cup, 3: sweetness, 4: total_cup_points
# i Use `colnames()` to see all variable names</code></pre>
</div>
</div>
<section id="logistic-regression" class="level3">
<h3 class="anchored" data-anchor-id="logistic-regression">Logistic Regression</h3>
<p>The first model I wanted to test with the current recipe was logistic regression. The <code>accuracy</code> and <code>roc auc</code> were alright for a starting model.</p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'glmnet' was built under R version 4.0.5</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'Matrix' was built under R version 4.0.5</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">collect_metrics</span>(lr_fit)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 x 6
  .metric     .estimator  mean     n std_err .config             
  &lt;chr&gt;       &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;               
1 accuracy    binary     0.698    10 0.00342 Preprocessor1_Model1
2 mn_log_loss binary     0.589    10 0.00775 Preprocessor1_Model1
3 roc_auc     binary     0.648    10 0.0188  Preprocessor1_Model1</code></pre>
</div>
</div>
</section>
<section id="lasso-regression" class="level3">
<h3 class="anchored" data-anchor-id="lasso-regression">Lasso Regression</h3>
<p>Now for the first penalized regression. The lasso regression did not improve in either metric. Let’s try the next penalized regression.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">collect_metrics</span>(lasso_fit)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 x 6
  .metric     .estimator  mean     n std_err .config             
  &lt;chr&gt;       &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;               
1 accuracy    binary     0.702    10 0.00397 Preprocessor1_Model1
2 mn_log_loss binary     0.592    10 0.00850 Preprocessor1_Model1
3 roc_auc     binary     0.645    10 0.0191  Preprocessor1_Model1</code></pre>
</div>
</div>
</section>
<section id="ridge-regression" class="level3">
<h3 class="anchored" data-anchor-id="ridge-regression">Ridge Regression</h3>
<p>The ridge regression was shown to not be a good fitting model. So I tested an additional penalized regression while tuning hyper-parameters.</p>
<div class="cell">
<pre class="rmetrics cell-code"><code>collect_metrics(ridge_fit)</code></pre>
</div>
</section>
<section id="elastic-net-regression" class="level3">
<h3 class="anchored" data-anchor-id="elastic-net-regression">Elastic Net Regression</h3>
<p>The elastic net regression had slightly better accuracy than the non-penalized logistic regression but the ROC AUC was exactly the same. While the elastic net regression did not take long computationally due to the small amount of data, this model would not be chosen over the logistic regression.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">collect_metrics</span>(elastic_fit)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 300 x 8
         penalty mixture .metric     .estimator  mean     n std_err .config     
           &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;       
 1 0.0000000001        0 accuracy    binary     0.698    10 0.00342 Preprocesso~
 2 0.0000000001        0 mn_log_loss binary     0.589    10 0.00775 Preprocesso~
 3 0.0000000001        0 roc_auc     binary     0.648    10 0.0188  Preprocesso~
 4 0.00000000129       0 accuracy    binary     0.698    10 0.00342 Preprocesso~
 5 0.00000000129       0 mn_log_loss binary     0.589    10 0.00775 Preprocesso~
 6 0.00000000129       0 roc_auc     binary     0.648    10 0.0188  Preprocesso~
 7 0.0000000167        0 accuracy    binary     0.698    10 0.00342 Preprocesso~
 8 0.0000000167        0 mn_log_loss binary     0.589    10 0.00775 Preprocesso~
 9 0.0000000167        0 roc_auc     binary     0.648    10 0.0188  Preprocesso~
10 0.000000215         0 accuracy    binary     0.698    10 0.00342 Preprocesso~
# ... with 290 more rows
# i Use `print(n = ...)` to see more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">show_best</span>(elastic_fit, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">metric =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"accuracy"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 x 8
        penalty mixture .metric  .estimator  mean     n std_err .config         
          &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;           
1 0.0774          0.111 accuracy binary     0.703    10 0.00434 Preprocessor1_M~
2 0.0000000001    0.333 accuracy binary     0.703    10 0.00422 Preprocessor1_M~
3 0.00000000129   0.333 accuracy binary     0.703    10 0.00422 Preprocessor1_M~
4 0.0000000167    0.333 accuracy binary     0.703    10 0.00422 Preprocessor1_M~
5 0.000000215     0.333 accuracy binary     0.703    10 0.00422 Preprocessor1_M~</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">show_best</span>(elastic_fit, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">metric =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"roc_auc"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 x 8
        penalty mixture .metric .estimator  mean     n std_err .config          
          &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;            
1 0.0000000001        0 roc_auc binary     0.648    10  0.0188 Preprocessor1_Mo~
2 0.00000000129       0 roc_auc binary     0.648    10  0.0188 Preprocessor1_Mo~
3 0.0000000167        0 roc_auc binary     0.648    10  0.0188 Preprocessor1_Mo~
4 0.000000215         0 roc_auc binary     0.648    10  0.0188 Preprocessor1_Mo~
5 0.00000278          0 roc_auc binary     0.648    10  0.0188 Preprocessor1_Mo~</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select_best</span>(elastic_fit, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">metric =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"accuracy"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 x 3
  penalty mixture .config               
    &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;                 
1  0.0774   0.111 Preprocessor1_Model019</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select_best</span>(elastic_fit, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">metric =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"roc_auc"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 x 3
       penalty mixture .config               
         &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;                 
1 0.0000000001       0 Preprocessor1_Model001</code></pre>
</div>
</div>
</section>
<section id="new-recipe" class="level3">
<h3 class="anchored" data-anchor-id="new-recipe">New Recipe</h3>
<p>Even though the elastic net regression was only slightly better, I decided to update the workflow using that model. This time I decided to update the recipe by including additional predictors like if there were any defects in the green coffee beans, the species of the coffee (e.g., Robusta and Arabica), and the country of origin. I also included additional steps in my recipe by transforming the category predictors and working with the factor predictors, like species, and country of origin. The inclusion of additional steps and the predictors created a better fitting model with the elastic net regression.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">05132021</span>)</span>
<span id="cb28-2"></span>
<span id="cb28-3">bal_rec <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">recipe</span>(process <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> aroma <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> flavor <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> aftertaste <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb28-4">                        acidity <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> body <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> balance <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> uniformity <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> clean_cup <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb28-5">                        sweetness <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> total_cup_points <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> category_one_defects <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> category_two_defects <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> species <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb28-6">                        country_of_origin,</span>
<span id="cb28-7">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> coffee_train) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb28-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">step_BoxCox</span>(category_two_defects, category_one_defects) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb28-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">step_novel</span>(species, country_of_origin) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb28-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">step_other</span>(species, country_of_origin, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">threshold =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">01</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb28-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">step_unknown</span>(species, country_of_origin) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb28-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">step_dummy</span>(species, country_of_origin) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb28-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">step_zv</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">all_predictors</span>(), <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">all_outcomes</span>())</span></code></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>! Fold01: preprocessor 1/1: Non-positive values in selected variable., No Box-Cox ...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>! Fold02: preprocessor 1/1: Non-positive values in selected variable., No Box-Cox ...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>! Fold03: preprocessor 1/1: Non-positive values in selected variable., No Box-Cox ...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>! Fold04: preprocessor 1/1: Non-positive values in selected variable., No Box-Cox ...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>! Fold05: preprocessor 1/1: Non-positive values in selected variable., No Box-Cox ...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>! Fold06: preprocessor 1/1: Non-positive values in selected variable., No Box-Cox ...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>! Fold07: preprocessor 1/1: Non-positive values in selected variable., No Box-Cox ...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>! Fold08: preprocessor 1/1: Non-positive values in selected variable., No Box-Cox ...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>! Fold09: preprocessor 1/1: Non-positive values in selected variable., No Box-Cox ...</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>! Fold10: preprocessor 1/1: Non-positive values in selected variable., No Box-Cox ...</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">collect_metrics</span>(elastic_bal_fit) </span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 300 x 8
         penalty mixture .metric     .estimator  mean     n std_err .config     
           &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;       
 1 0.0000000001        0 accuracy    binary     0.839    10 0.00923 Preprocesso~
 2 0.0000000001        0 mn_log_loss binary     0.431    10 0.0153  Preprocesso~
 3 0.0000000001        0 roc_auc     binary     0.840    10 0.0163  Preprocesso~
 4 0.00000000129       0 accuracy    binary     0.839    10 0.00923 Preprocesso~
 5 0.00000000129       0 mn_log_loss binary     0.431    10 0.0153  Preprocesso~
 6 0.00000000129       0 roc_auc     binary     0.840    10 0.0163  Preprocesso~
 7 0.0000000167        0 accuracy    binary     0.839    10 0.00923 Preprocesso~
 8 0.0000000167        0 mn_log_loss binary     0.431    10 0.0153  Preprocesso~
 9 0.0000000167        0 roc_auc     binary     0.840    10 0.0163  Preprocesso~
10 0.000000215         0 accuracy    binary     0.839    10 0.00923 Preprocesso~
# ... with 290 more rows
# i Use `print(n = ...)` to see more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">show_best</span>(elastic_bal_fit, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">metric =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"accuracy"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 x 8
   penalty mixture .metric  .estimator  mean     n std_err .config              
     &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;                
1 0.000464   0.111 accuracy binary     0.840    10 0.0101  Preprocessor1_Model0~
2 0.000464   0.222 accuracy binary     0.840    10 0.0101  Preprocessor1_Model0~
3 0.00599    0.111 accuracy binary     0.840    10 0.00933 Preprocessor1_Model0~
4 0.00599    0.222 accuracy binary     0.840    10 0.00933 Preprocessor1_Model0~
5 0.00599    0.333 accuracy binary     0.840    10 0.00933 Preprocessor1_Model0~</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">show_best</span>(elastic_bal_fit, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">metric =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mn_log_loss"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 x 8
   penalty mixture .metric     .estimator  mean     n std_err .config           
     &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;             
1 0.000464   1     mn_log_loss binary     0.420    10  0.0179 Preprocessor1_Mod~
2 0.000464   0.889 mn_log_loss binary     0.420    10  0.0178 Preprocessor1_Mod~
3 0.000464   0.778 mn_log_loss binary     0.420    10  0.0178 Preprocessor1_Mod~
4 0.000464   0.667 mn_log_loss binary     0.420    10  0.0178 Preprocessor1_Mod~
5 0.000464   0.556 mn_log_loss binary     0.420    10  0.0177 Preprocessor1_Mod~</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">show_best</span>(elastic_bal_fit, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">metric =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"roc_auc"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 x 8
   penalty mixture .metric .estimator  mean     n std_err .config               
     &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;                 
1 0.00599    0.778 roc_auc binary     0.843    10  0.0150 Preprocessor1_Model078
2 0.000464   0.667 roc_auc binary     0.843    10  0.0141 Preprocessor1_Model067
3 0.00599    0.889 roc_auc binary     0.843    10  0.0148 Preprocessor1_Model088
4 0.000464   0.444 roc_auc binary     0.843    10  0.0141 Preprocessor1_Model047
5 0.000464   0.556 roc_auc binary     0.843    10  0.0141 Preprocessor1_Model057</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select_best</span>(elastic_bal_fit, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">metric =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"accuracy"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 x 3
   penalty mixture .config               
     &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;                 
1 0.000464   0.111 Preprocessor1_Model017</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select_best</span>(elastic_bal_fit, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">metric =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mn_log_loss"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 x 3
   penalty mixture .config               
     &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;                 
1 0.000464       1 Preprocessor1_Model097</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select_best</span>(elastic_bal_fit, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">metric =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"roc_auc"</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 x 3
  penalty mixture .config               
    &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;                 
1 0.00599   0.778 Preprocessor1_Model078</code></pre>
</div>
</div>
<p>Now using the testing dataset, we can see how well the final model fit the testing data. While not the best at predicting washed green coffee beans, this was a good test to show that the penalized regressions are not always the best fitting models compared to regular logistic regression. In the end, it seemed like the recipe was the most important component to predicting washed green coffee beans.</p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>! train/test split: preprocessor 1/1: Non-positive values in selected variable., No Box-Cox ...</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb54" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1">final_results <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb54-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">collect_metrics</span>()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 x 4
  .metric  .estimator .estimate .config             
  &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;               
1 accuracy binary         0.823 Preprocessor1_Model1
2 roc_auc  binary         0.817 Preprocessor1_Model1</code></pre>
</div>
</div>


</section>
</section>

 ]]></description>
  <category>Visualizations</category>
  <category>Analysis</category>
  <category>Tidy Tuesday</category>
  <guid>https://log-of-jandp.com/posts/2021-05-13-tidy-tuesday-coffee-ratings/index.html</guid>
  <pubDate>Thu, 13 May 2021 07:00:00 GMT</pubDate>
  <media:content url="https://log-of-jandp.com/posts/2021-05-13-tidy-tuesday-coffee-ratings/coffee_process.jpg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Twitter Conference Presentation</title>
  <link>https://log-of-jandp.com/posts/2021-04-30-twitter-conference-presentation/index.html</link>
  <description><![CDATA[ 




<p>I thought I’d talk about the analyses I conducted for my submission to the American Public Health Association Physical Activity Section’s Twitter Conference. I thought it was a fun opportunity to disseminate some analyses that I conducted using public data from the <a href="https://www.countyhealthrankings.org/">County Health Rankings and Roadmap</a> to examine what factors are associated with leisure-time physical activity (LTPA) in counties in California from 2016 to 2020. If you are interested in the presentation itself, you can follow it <a href="https://twitter.com/PaSectionAPHA/status/1309192269447143425">here</a>.</p>
<p>Physical activity is important as its related to many physical and mental health conditions. It is also a health behavior that can be modified slightly easier than other health behaviors. While not as beneficial as extended periods of exercise, even walking for leisure can be beneficial for one’s health. I was predominately interested in California because I wanted to know how much variation there was between the counties. For instance, there are areas like San Francisco county and Los Angeles County, which may be seen as hubs for cultures of being physically active, but what about counties throughout Central California. I’m also interested in LTPA engagement because this health behavior has several social determinants of health that impact how much LTPA individuals can engage in. The social determinant that I’m most interested in is the role that access to recreational facilities and parks have on counties’ LTPA engagement. Since I was interested in looking at variation between counties while also examining the longitudinal association between access and LTPA, I decided to create a two-level multilevel model with time (level 1) nested within counties (level 2).</p>
<section id="packages-ued" class="level3">
<h3 class="anchored" data-anchor-id="packages-ued">Packages ued</h3>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'tidyverse' was built under R version 4.0.5</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>-- Attaching packages --------------------------------------- tidyverse 1.3.1 --</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>v ggplot2 3.3.6     v purrr   0.3.4
v tibble  3.1.8     v dplyr   1.0.9
v tidyr   1.2.0     v stringr 1.4.0
v readr   2.1.2     v forcats 0.5.1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'tidyr' was built under R version 4.0.5</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'readr' was built under R version 4.0.5</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'forcats' was built under R version 4.0.5</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>-- Conflicts ------------------------------------------ tidyverse_conflicts() --
x dplyr::filter() masks stats::filter()
x dplyr::lag()    masks stats::lag()</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'inspectdf' was built under R version 4.0.5</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'psych'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:ggplot2':

    %+%, alpha</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: Matrix</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'Matrix' was built under R version 4.0.5</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'Matrix'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:tidyr':

    expand, pack, unpack</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'lmerTest'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:lme4':

    lmer</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:stats':

    step</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Google's Terms of Service: https://cloud.google.com/maps-platform/terms/.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Please cite ggmap if you use it! See citation("ggmap") for details.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'maps' was built under R version 4.0.5</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'maps'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:purrr':

    map</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'RColorBrewer' was built under R version 4.0.5</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'ggrepel' was built under R version 4.0.5</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'gganimate' was built under R version 4.0.4</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'transformr' was built under R version 4.0.5</code></pre>
</div>
<div class="cell-output-display">
<p><img src="https://log-of-jandp.com/posts/2021-04-30-twitter-conference-presentation/index_files/figure-html/packages used-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="functions" class="level3">
<h3 class="anchored" data-anchor-id="functions">Functions</h3>
<p>Before beginning I created a simple function to get the intraclass correlation coefficient (ICC). I also included a function to get data from the 5 years of County Health Rankings data. The function to get the ICC from random-intercept models is the between county variation divided by the total variation between counties and within counties. This gives you information about how much of the variation in the model can be attributed to differences between counties regarding your outcome. Random-intercept models were tested because I was only interested in knowing the variation in counties’ LTPA engagement. There were also not enough points for each county to test individual slopes for each county (random-slopes model).</p>
<p>I also made some slight changes to my data. The first was to get rid of the estimates for each state and only focus on estimates from the county. I also wanted to treat year as a continuous variable in my models but wanted to keep the <code>year</code> variable as a factor too. Then after filtering to only examine California counties I used the <code>str_replace_all</code> function from the <code>stringr</code> package to get rid of the county name after each observation. This was to make it easier to join with map data from the <code>maps</code> package. Lastly, I made the counties title case to also make joining the observations easier.</p>
</section>
<section id="models" class="level3">
<h3 class="anchored" data-anchor-id="models">Models</h3>
<p>Now when running the first model, I was first interested in examining if there was an increase in LTPA engagement in all California counties from 2016 to 2020. From the finding below, it shows that in California, there was a decrease in LTPA over that time. It’s also important to note that <code>lmerTest</code> and <code>lme4</code> both have a <code>lmer</code> function. By namespacing them with two colons, you can see that the summary information is slightly different.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1">preliminary_ltpa_long <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> lmerTest<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lmer</span>(ltpa_percent <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> year_num <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> county_fips_code), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> ca,</span>
<span id="cb27-2">                              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">REML =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb27-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(preliminary_ltpa_long)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by maximum likelihood . t-tests use Satterthwaite's
  method [lmerModLmerTest]
Formula: ltpa_percent ~ year_num + (1 | county_fips_code)
   Data: ca

     AIC      BIC   logLik deviance df.resid 
  1427.9   1442.5   -709.9   1419.9      286 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-5.6854 -0.3709  0.0361  0.5377  1.7084 

Random effects:
 Groups           Name        Variance Std.Dev.
 county_fips_code (Intercept) 7.187    2.681   
 Residual                     5.174    2.275   
Number of obs: 290, groups:  county_fips_code, 58

Fixed effects:
              Estimate Std. Error         df t value            Pr(&gt;|t|)    
(Intercept) 1923.40172  190.60225  231.84941  10.091 &lt;0.0000000000000002 ***
year_num      -0.91276    0.09445  231.84760  -9.664 &lt;0.0000000000000002 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
         (Intr)
year_num -1.000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1">prelim_ltpa_lmer <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> lme4<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lmer</span>(ltpa_percent <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> year_num <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> county_fips_code), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> ca,</span>
<span id="cb29-2">                              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">REML =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb29-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(prelim_ltpa_lmer)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by maximum likelihood  ['lmerMod']
Formula: ltpa_percent ~ year_num + (1 | county_fips_code)
   Data: ca

     AIC      BIC   logLik deviance df.resid 
  1427.9   1442.5   -709.9   1419.9      286 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-5.6854 -0.3709  0.0361  0.5377  1.7084 

Random effects:
 Groups           Name        Variance Std.Dev.
 county_fips_code (Intercept) 7.187    2.681   
 Residual                     5.174    2.275   
Number of obs: 290, groups:  county_fips_code, 58

Fixed effects:
              Estimate Std. Error t value
(Intercept) 1923.40172  190.60225  10.091
year_num      -0.91276    0.09445  -9.664

Correlation of Fixed Effects:
         (Intr)
year_num -1.000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1">ltpa_null_icc <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">VarCorr</span>(preliminary_ltpa_long))</span>
<span id="cb31-2">ltpa_null_icc</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 x 5
  grp              var1        var2   vcov sdcor
  &lt;chr&gt;            &lt;chr&gt;       &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;
1 county_fips_code (Intercept) &lt;NA&gt;   7.19  2.68
2 Residual         &lt;NA&gt;        &lt;NA&gt;   5.17  2.27</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">county_icc_2level</span>(ltpa_null_icc)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5814093</code></pre>
</div>
</div>
<p>Along with the fixed effects, we also got our random effects for both differences found between counties for LTPA engagement and differences within counties for LTPA engagement. This shows that there was a good amount of variation between counties (σ2 = 7.19) but also a large amount of variation within each county in California (σ2 = 5.17). Using the function to calculate the ICC, it found that county differences attributed to 58% of the variation in LTPA engagement. Something that should be considered is the potential for heteroscedastic residual variance at level 1. There is also the issue that the residuals could suggest spatial autocorrelation or clustering within these counties. Maybe I’ll create something on these soon. But for the time being, lets move on to what was found for the twitter conference.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1">ltpa_long_access <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lmer</span>(ltpa_percent <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> year_num <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> violent_crime <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> obesity_percent <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> median_household_income <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> rural_percent <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb35-2">                           access_pa_percent <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> county_fips_code), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> ca,</span>
<span id="cb35-3">                         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">REML =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Some predictor variables are on very different scales: consider
rescaling

Warning: Some predictor variables are on very different scales: consider
rescaling</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">anova</span>(preliminary_ltpa_long, ltpa_long_access)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: ca
Models:
preliminary_ltpa_long: ltpa_percent ~ year_num + (1 | county_fips_code)
ltpa_long_access: ltpa_percent ~ year_num + violent_crime + obesity_percent + median_household_income + rural_percent + access_pa_percent + (1 | county_fips_code)
                      npar    AIC    BIC  logLik deviance  Chisq Df
preliminary_ltpa_long    4 1427.9 1442.5 -709.93   1419.9          
ltpa_long_access         9 1237.4 1270.4 -609.69   1219.4 200.47  5
                                 Pr(&gt;Chisq)    
preliminary_ltpa_long                          
ltpa_long_access      &lt; 0.00000000000000022 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1">other_var <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lmer</span>(ltpa_percent <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> year_num <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> violent_crime <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> obesity_percent <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> median_household_income <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> rural_percent <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> county_fips_code), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> ca,</span>
<span id="cb39-2">                         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">REML =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Some predictor variables are on very different scales: consider
rescaling

Warning: Some predictor variables are on very different scales: consider
rescaling</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">anova</span>(other_var, ltpa_long_access)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: ca
Models:
other_var: ltpa_percent ~ year_num + violent_crime + obesity_percent + median_household_income + rural_percent + (1 | county_fips_code)
ltpa_long_access: ltpa_percent ~ year_num + violent_crime + obesity_percent + median_household_income + rural_percent + access_pa_percent + (1 | county_fips_code)
                 npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)  
other_var           8 1240.1 1269.4 -612.04   1224.1                       
ltpa_long_access    9 1237.4 1270.4 -609.69   1219.4 4.6883  1    0.03037 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>With the inclusion of several predictors for fixed effects, a likelihood ratio test was conducted to see if the inclusion of these fixed effects revealed a significantly better fitting model. The inclusion of these predictors revealed a better fitting model. It would probably be better to see if the inclusion of one variable of interest, such as access, resulted in a better fitting model than a model with the other social determinants of health. As can be see here, the likelihood ratio test of including only access still resulted in a signifcantly better fitting model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summary</span>(ltpa_long_access)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by maximum likelihood . t-tests use Satterthwaite's
  method [lmerModLmerTest]
Formula: 
ltpa_percent ~ year_num + violent_crime + obesity_percent + median_household_income +  
    rural_percent + access_pa_percent + (1 | county_fips_code)
   Data: ca

     AIC      BIC   logLik deviance df.resid 
  1237.4   1270.4   -609.7   1219.4      281 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-4.8388 -0.5546  0.0010  0.6179  2.4921 

Random effects:
 Groups           Name        Variance Std.Dev.
 county_fips_code (Intercept) 1.286    1.134   
 Residual                     3.139    1.772   
Number of obs: 290, groups:  county_fips_code, 58

Fixed effects:
                              Estimate     Std. Error             df t value
(Intercept)             1138.319788532  193.185926311  289.534084001   5.892
year_num                  -0.517087679    0.096244053  289.365967843  -5.373
violent_crime             -0.001434185    0.001190066   82.732732827  -1.205
obesity_percent           -0.602338792    0.043760246  262.840285406 -13.765
median_household_income    0.000004822    0.000014701  102.255260100   0.328
rural_percent             -0.012178273    0.007671490   63.272282539  -1.587
access_pa_percent          0.027194696    0.012124625  153.692013407   2.243
                                    Pr(&gt;|t|)    
(Intercept)                     0.0000000106 ***
year_num                        0.0000001597 ***
violent_crime                         0.2316    
obesity_percent         &lt; 0.0000000000000002 ***
median_household_income               0.7436    
rural_percent                         0.1174    
access_pa_percent                     0.0263 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) yer_nm vlnt_c obsty_ mdn_h_ rrl_pr
year_num    -1.000                                   
violent_crm  0.116 -0.118                            
obsty_prcnt  0.489 -0.494 -0.100                     
mdn_hshld_n  0.586 -0.589  0.203  0.452              
rural_prcnt  0.260 -0.264  0.135  0.203  0.447       
accss_p_prc -0.147  0.142 -0.018  0.054 -0.341  0.158
fit warnings:
Some predictor variables are on very different scales: consider rescaling</code></pre>
</div>
</div>
<p>The model summary suggests that the fixed effect of access on LTPA engagement was significantly associated. The thing that stands out the most here is that the inclusion of the predictors resulted in more variation within counties than between counties. So lets look into that more closely.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1">ltpa_access_icc <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">VarCorr</span>(ltpa_long_access))</span>
<span id="cb45-2">ltpa_access_icc</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 x 5
  grp              var1        var2   vcov sdcor
  &lt;chr&gt;            &lt;chr&gt;       &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;
1 county_fips_code (Intercept) &lt;NA&gt;   1.29  1.13
2 Residual         &lt;NA&gt;        &lt;NA&gt;   3.14  1.77</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">county_icc_2level</span>(ltpa_access_icc)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2906253</code></pre>
</div>
</div>
<p>The ICC suggests that 29% of the variation explained is from differences between counties. It is also beneficial to look at all of this through visuals.</p>
</section>
<section id="visuals-prep" class="level3">
<h3 class="anchored" data-anchor-id="visuals-prep">Visuals Prep</h3>
<p>Below we’ll start by using the <code>maps</code> package to get county-level data of the contiguous United States. The steps below were to make sure this data frame joined with the county health rankings data we had created previously.</p>
</section>
<section id="visualizing-model" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-model">Visualizing model</h3>
<p>One way to visualize the variation between counties in our final model (<code>ltpa_long_access</code>) is to use a caterpillar plot. This allows you to view variation in the residuals of each county for your outcome. From the visual, you can see the differences between Humboldt County and Tehama County.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1">main_effects_var <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ranef</span>(ltpa_long_access, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">condVar =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb49-2"></span>
<span id="cb49-3">main_effects_var <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>(main_effects_var)</span>
<span id="cb49-4"></span>
<span id="cb49-5">main_effects_var <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> main_effects_var <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb49-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main_effects_term =</span> term,</span>
<span id="cb49-7">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">county_fips_code =</span> grp,</span>
<span id="cb49-8">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main_effects_diff =</span> condval,</span>
<span id="cb49-9">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">main_effects_se =</span> condsd,</span>
<span id="cb49-10">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">county_fips_code =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(county_fips_code))</span>
<span id="cb49-11"></span>
<span id="cb49-12">main_effects_var<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>no_name_county <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(ca<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>no_name_county)</span>
<span id="cb49-13"></span>
<span id="cb49-14">main_effects_var <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb49-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_reorder</span>(no_name_county, main_effects_diff), main_effects_diff)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb49-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_errorbar</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin =</span> main_effects_diff <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">qnorm</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.025</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>main_effects_se,</span>
<span id="cb49-17">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax =</span> main_effects_diff <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">qnorm</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.975</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>main_effects_se)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb49-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> no_name_county)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb49-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_flip</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb49-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">' '</span>,</span>
<span id="cb49-21">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Differences in Leisure-time Physical Activity'</span>,</span>
<span id="cb49-22">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Variation in Leisure-time Physical Activity</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Across California Counties'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb49-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'none'</span>)</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://log-of-jandp.com/posts/2021-04-30-twitter-conference-presentation/index_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This plot shows the fixed effect of access and LTPA across the various years.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1">ca <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb50-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">year =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(year)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb50-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(access_pa_percent, ltpa_percent)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb50-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> year)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb50-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'dodgerblue'</span>,</span>
<span id="cb50-6">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'lm'</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">se =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb50-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>()) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb50-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Access to Physical Activity Opportunities'</span>,</span>
<span id="cb50-9">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Leisure-time Physical Activity'</span>,</span>
<span id="cb50-10">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'The Statewide Association of Access</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">and Physical Activity'</span>)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="https://log-of-jandp.com/posts/2021-04-30-twitter-conference-presentation/index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Finally, a gif of the change of LTPA from 2016 to 2020.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(gganimate)</span>
<span id="cb52-2"></span>
<span id="cb52-3">ca_animate <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> ca_visual <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb52-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">frame =</span> year,</span>
<span id="cb52-5">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cumulative =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb52-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_polygon</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> long, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> lat, </span>
<span id="cb52-7">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> group, </span>
<span id="cb52-8">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> ltpa_percent),</span>
<span id="cb52-9">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'black'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb52-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_gradientn</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colors =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">brewer.pal</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">name =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'RdYlGn'</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb52-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_classic</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb52-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">transition_time</span>(year) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb52-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Longitude'</span>,</span>
<span id="cb52-14">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Latitude'</span>,</span>
<span id="cb52-15">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Leisure-time Physical Activity</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">Change Over Time'</span>,</span>
<span id="cb52-16">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Year: {frame_time}'</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb52-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb52-18">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>),</span>
<span id="cb52-19">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>),</span>
<span id="cb52-20">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>),</span>
<span id="cb52-21">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.title =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>),</span>
<span id="cb52-22">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span>))</span>
<span id="cb52-23"></span>
<span id="cb52-24"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(gifski)</span></code></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'gifski' was built under R version 4.0.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">animate</span>(ca_animate, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">renderer =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gifski_renderer</span>())</span></code></pre></div>
<div class="cell-output-display">
<p><img src="https://log-of-jandp.com/posts/2021-04-30-twitter-conference-presentation/index_files/figure-html/unnamed-chunk-3-1.gif" class="img-fluid"></p>
</div>
</div>


</section>

 ]]></description>
  <category>Visualizations</category>
  <category>Analysis</category>
  <guid>https://log-of-jandp.com/posts/2021-04-30-twitter-conference-presentation/index.html</guid>
  <pubDate>Fri, 30 Apr 2021 07:00:00 GMT</pubDate>
  <media:content url="https://log-of-jandp.com/posts/2021-04-30-twitter-conference-presentation/la_view.jpg" medium="image" type="image/jpeg"/>
</item>
</channel>
</rss>
